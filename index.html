<html>
<head><meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.4/codemirror.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.15.6/katex.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/antd/4.20.5/antd.compact.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>
<body>
<div style="margin:30px 30px 0 0"><div style="margin-bottom:15px"><b>Kernel:</b> <!-- -->Python 3 (system-wide)</div><div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><h1 id="tutorial-of-solar-flares-data-analysis"><span>Tutorial of Solar Flares Data Analysis</span></h1></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><h4 id="this-tutorial-provides-a-walk-through-of-how-to-provide-better-data-about-the-top-50-solar-flares-recorded-so-far-than-that-shown-by-spaceweatherlivecom-in-this-tutorial-i-scrape-data-from-spaceweatherlivecom-and-windwaves-type-ii-bursts-and-cmes-using-requests-and-beautifulsoup-i-save-both-sets-of-data-as-dataframes-using-pandas-i-then-tidy-this-data-by-coding-missing-observations-properly-recoding-columns-that-correspond-to-more-than-one-piece-of-information-and-treating-dates-and-times-appropriately-finally-i-provide-a-data-analysis-comparing-the-solar-flare-data-obtained-from-spaceweatherlivecom-and-nasa"><span>This tutorial provides a walk-through of how to provide better data about the top 50 solar flares recorded so far than that shown by </span><a href="https://www.spaceweatherlive.com/en/solar-activity/top-50-solar-flares.html" target="_blank" rel="noopener"><span>SpaceWeatherLive.com</span></a><span>. In this tutorial, I scrape data from  </span><a href="https://www.spaceweatherlive.com/en/solar-activity/top-50-solar-flares.html" target="_blank" rel="noopener"><span>SpaceWeatherLive.com</span></a><span> and  </span><a href="http://www.hcbravo.org/IntroDataSci/misc/waves_type2.html" target="_blank" rel="noopener"><span>Wind/WAVES type II bursts and CMEs</span></a><span> using requests and BeautifulSoup. I save both sets of data as dataframes using Pandas. I then tidy this data by coding missing observations properly, recoding columns that correspond to more than one piece of information, and treating dates and times appropriately. Finally, I provide a data analysis comparing the solar flare data obtained from </span><a href="http://SpaceWeatherLive.com" target="_blank" rel="noopener"><span>SpaceWeatherLive.com</span></a><span> and NASA.</span></h4></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><h2 id="install-and-import-necessary-packages"><span>Install and Import Necessary Packages</span></h2></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px">In [<!-- -->0<!-- -->]:</div><div style="width:100%;border-radius:2px;position:relative;overflow-x:auto;border:1px solid rgb(207, 207, 207)"><pre class="CodeMirror cm-s-default  CodeMirror-wrap" style="width:100%;overflow-x:auto;line-height:normal;height:auto;font-size:inherit;margin-bottom:0;padding:4px;white-space:pre-wrap;word-wrap:break-word;word-break:normal;border:0;background:white"><div style="margin-left:0"><span class="cm-operator">!</span><span class="cm-variable">pip3</span><span> </span><span class="cm-variable">install</span><span> </span><span class="cm-variable">lxml</span><span>
</span></div></pre></div></div><div style="display:flex;flex-direction:row;align-items:stretch" cocalc-test="cell-output"><div class="ant-btn ant-btn-default" style="border-color:transparent;font-size:inherit;padding:0;display:flex;flex-direction:column;height:auto"><div style="color:#D84315;min-width:7em;font-family:monospace;text-align:right;padding-right:5px;padding-bottom:2px"></div><div style="flex:1"></div> </div><div style="flex:1;overflow-x:auto;line-height:normal;background-color:#fff;border:0;margin-bottom:0;margin-left:1px" class="cocalc-jupyter-rendered"><div style="white-space:pre-wrap;word-wrap:break-word;font-family:monospace;padding-top:5px;padding-bottom:5px"><code><span>Requirement already satisfied: lxml in /opt/conda/lib/python3.9/site-packages (4.6.4)
</span></code></div></div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px">In [<!-- -->0<!-- -->]:</div><div style="width:100%;border-radius:2px;position:relative;overflow-x:auto;border:1px solid rgb(207, 207, 207)"><pre class="CodeMirror cm-s-default  CodeMirror-wrap" style="width:100%;overflow-x:auto;line-height:normal;height:auto;font-size:inherit;margin-bottom:0;padding:4px;white-space:pre-wrap;word-wrap:break-word;word-break:normal;border:0;background:white"><div style="margin-left:0"><span class="cm-comment"># Import beautifulsoup4, requests, pandas, numpy, re</span><span>
</span><span class="cm-keyword">import</span><span> </span><span class="cm-variable">requests</span><span>
</span><span class="cm-keyword">from</span><span> </span><span class="cm-variable">bs4</span><span> </span><span class="cm-keyword">import</span><span> </span><span class="cm-variable">BeautifulSoup</span><span>
</span><span class="cm-keyword">import</span><span> </span><span class="cm-variable">pandas</span><span> </span><span class="cm-keyword">as</span><span> </span><span class="cm-variable">pd</span><span>
</span><span class="cm-keyword">import</span><span> </span><span class="cm-variable">re</span><span>
</span><span class="cm-keyword">import</span><span> </span><span class="cm-variable">numpy</span><span> </span><span class="cm-keyword">as</span><span> </span><span class="cm-variable">np</span><span>
</span></div></pre></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><h2 id="step-1-scrape-your-competitor’s-data"><span>Step 1: Scrape Your Competitor’s Data</span></h2></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><h4 id="first-i-scrape-data-for-the-top-50-solar-flares-shown-in-spaceweatherlivecom-using-beautifulsoup-and-save-it-as-a-pandas-dataframe-the-result-below-is-a-50-row-x-8-column-dataframe-"><span>First, I scrape data for the top 50 solar flares shown in </span><a href="https://www.spaceweatherlive.com/en/solar-activity/top-50-solar-flares.html" target="_blank" rel="noopener"><span>SpaceWeatherLive.com</span></a><span> using BeautifulSoup and save it as a Pandas dataframe. </span><span style="display:inline"><span><br/></span></span><span> The result below is a 50 row x 8 column dataframe. </span></h4></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px">In [<!-- -->0<!-- -->]:</div><div style="width:100%;border-radius:2px;position:relative;overflow-x:auto;border:1px solid rgb(207, 207, 207)"><pre class="CodeMirror cm-s-default  CodeMirror-wrap" style="width:100%;overflow-x:auto;line-height:normal;height:auto;font-size:inherit;margin-bottom:0;padding:4px;white-space:pre-wrap;word-wrap:break-word;word-break:normal;border:0;background:white"><div style="margin-left:0"><span class="cm-variable">url</span><span> </span><span>=</span><span> </span><span class="cm-string">&#x27;https://www.spaceweatherlive.com/en/solar-activity/top-50-solar-flares.html&#x27;</span><span>
</span><span class="cm-variable">headers</span><span> </span><span>=</span><span> </span><span>{</span><span class="cm-string">&#x27;User-Agent&#x27;</span><span>:</span><span> </span><span class="cm-string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/94.0.4606.61 Safari/537.36&#x27;</span><span>}</span><span>
</span><span>
</span><span class="cm-comment"># Use requests to get url</span><span>
</span><span class="cm-variable">response</span><span> </span><span>=</span><span> </span><span class="cm-variable">requests</span><span>.</span><span class="cm-variable">get</span><span>(</span><span class="cm-variable">url</span><span>,</span><span> </span><span class="cm-variable">headers</span><span>=</span><span class="cm-variable">headers</span><span>)</span><span>
</span><span>
</span><span class="cm-comment"># Use BeautifulSoup to read &amp; parse the data</span><span>
</span><span class="cm-variable">soup</span><span> </span><span>=</span><span> </span><span class="cm-variable">BeautifulSoup</span><span>(</span><span class="cm-variable">response</span><span>.</span><span class="cm-variable">content</span><span>,</span><span> </span><span class="cm-string">&#x27;html.parser&#x27;</span><span>)</span><span>
</span><span>
</span><span class="cm-comment"># Use prettify() to view content &amp; find appropriate table</span><span>
</span><span class="cm-variable">soup</span><span>.</span><span class="cm-variable">prettify</span><span>(</span><span>)</span><span>
</span><span>
</span><span class="cm-comment"># Use find() to save the table as a variable</span><span>
</span><span class="cm-variable">table</span><span> </span><span>=</span><span> </span><span class="cm-variable">soup</span><span>.</span><span class="cm-variable">find</span><span>(</span><span class="cm-string">&quot;table&quot;</span><span>)</span><span>
</span><span>
</span><span class="cm-comment"># Use pandas to read in the HTML file</span><span>
</span><span class="cm-variable">soup_df</span><span> </span><span>=</span><span> </span><span class="cm-variable">pd</span><span>.</span><span class="cm-variable">read_html</span><span>(</span><span class="cm-builtin">str</span><span>(</span><span class="cm-variable">table</span><span>)</span><span>)</span><span>
</span><span class="cm-variable">soup_df</span><span> </span><span>=</span><span> </span><span class="cm-variable">pd</span><span>.</span><span class="cm-variable">DataFrame</span><span>(</span><span class="cm-variable">soup_df</span><span>[</span><span class="cm-number">0</span><span>]</span><span>)</span><span>
</span><span class="cm-variable">soup_df</span><span>.</span><span class="cm-variable">columns</span><span>
</span><span>
</span><span class="cm-comment"># Set reasonable names for the table columns (pandas.DataFrame.columns)</span><span>
</span><span class="cm-variable">soup_df</span><span>.</span><span class="cm-variable">rename</span><span>(</span><span class="cm-variable">columns</span><span> </span><span>=</span><span> </span><span>{</span><span class="cm-string">&#x27;Unnamed: 0&#x27;</span><span> </span><span>:</span><span> </span><span class="cm-string">&#x27;Rank&#x27;</span><span>,</span><span> </span><span class="cm-string">&#x27;Unnamed: 1&#x27;</span><span> </span><span>:</span><span> </span><span class="cm-string">&#x27;X Class&#x27;</span><span>,</span><span> </span><span class="cm-string">&#x27;Unnamed: 2&#x27;</span><span> </span><span>:</span><span> </span><span class="cm-string">&#x27;Date&#x27;</span><span>,</span><span> </span><span class="cm-string">&#x27;Unnamed: 7&#x27;</span><span> </span><span>:</span><span> </span><span class="cm-string">&#x27;Movie&#x27;</span><span>,</span><span> </span><span class="cm-string">&#x27;Start&#x27;</span><span> </span><span>:</span><span> </span><span class="cm-string">&#x27;Start Time&#x27;</span><span>,</span><span> </span><span class="cm-string">&#x27;Maximum&#x27;</span><span> </span><span>:</span><span> </span><span class="cm-string">&#x27;Max Time&#x27;</span><span>,</span><span> </span><span class="cm-string">&#x27;End&#x27;</span><span> </span><span>:</span><span> </span><span class="cm-string">&#x27;End Time&#x27;</span><span>}</span><span>,</span><span> </span><span class="cm-variable">inplace</span><span> </span><span>=</span><span> </span><span class="cm-keyword">True</span><span>)</span><span>
</span><span>
</span><span class="cm-comment"># Display table with new column names</span><span>
</span><span class="cm-variable">display</span><span>(</span><span class="cm-variable">soup_df</span><span>.</span><span class="cm-variable">head</span><span>(</span><span class="cm-number">11</span><span>)</span><span>)</span><span>
</span><span>
</span></div></pre></div></div><div style="display:flex;flex-direction:row;align-items:stretch" cocalc-test="cell-output"><div class="ant-btn ant-btn-default" style="font-size:inherit;padding:0;display:flex;flex-direction:column;height:auto"><div style="color:#D84315;min-width:7em;font-family:monospace;text-align:right;padding-right:5px;padding-bottom:2px"></div><div style="flex:1"></div> </div><div style="flex:1;overflow-x:auto;line-height:normal;background-color:#fff;border:0;margin-bottom:0;margin-left:1px;max-height:40vh" class="cocalc-jupyter-rendered"><div style="margin:5px 0"><div><div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>Rank</th><th>X Class</th><th>Date</th><th>Region</th><th>Start Time</th><th>Max Time</th><th>End Time</th><th>Movie</th></tr></thead><tbody><tr><th>0</th><td>1</td><td>X28+</td><td>2003/11/04</td><td>486</td><td>19:29</td><td>19:53</td><td>20:06</td><td>MovieView archive</td></tr><tr><th>1</th><td>2</td><td>X20+</td><td>2001/04/02</td><td>9393</td><td>21:32</td><td>21:51</td><td>22:03</td><td>MovieView archive</td></tr><tr><th>2</th><td>3</td><td>X17.2+</td><td>2003/10/28</td><td>486</td><td>09:51</td><td>11:10</td><td>11:24</td><td>MovieView archive</td></tr><tr><th>3</th><td>4</td><td>X17+</td><td>2005/09/07</td><td>808</td><td>17:17</td><td>17:40</td><td>18:03</td><td>MovieView archive</td></tr><tr><th>4</th><td>5</td><td>X14.4</td><td>2001/04/15</td><td>9415</td><td>13:19</td><td>13:50</td><td>13:55</td><td>MovieView archive</td></tr><tr><th>5</th><td>6</td><td>X10</td><td>2003/10/29</td><td>486</td><td>20:37</td><td>20:49</td><td>21:01</td><td>MovieView archive</td></tr><tr><th>6</th><td>7</td><td>X9.4</td><td>1997/11/06</td><td>8100</td><td>11:49</td><td>11:55</td><td>12:01</td><td>MovieView archive</td></tr><tr><th>7</th><td>8</td><td>X9.3</td><td>2017/09/06</td><td>2673</td><td>11:53</td><td>12:02</td><td>12:10</td><td>MovieView archive</td></tr><tr><th>8</th><td>9</td><td>X9</td><td>2006/12/05</td><td>930</td><td>10:18</td><td>10:35</td><td>10:45</td><td>MovieView archive</td></tr><tr><th>9</th><td>10</td><td>X8.3</td><td>2003/11/02</td><td>486</td><td>17:03</td><td>17:25</td><td>17:39</td><td>MovieView archive</td></tr><tr><th>10</th><td>11</td><td>X8.2</td><td>2017/09/10</td><td>2673</td><td>15:35</td><td>16:06</td><td>16:31</td><td>MovieView archive</td></tr></tbody></table>
</div></div></div></div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><h2 id="step-2-tidy-the-top-50-solar-flare-data"><span>Step 2: Tidy the Top 50 Solar Flare Data</span></h2></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><h4 id="next-i-tidy-the-top-50-solar-flare-data-by-removing-unnecessary-data-this-includes-dropping-irrelevant-columns-rearranging-columns-and-treating-dates-and-times-appropriately-by-combining-them-into-datetime-columns-the-final-result-is-a-50-row-x-6-column-dataframe"><span>Next, I tidy the Top 50 Solar Flare data by removing unnecessary data. This includes dropping irrelevant columns, rearranging columns, and treating dates and times appropriately by combining them into datetime columns. The final result is a 50 row x 6 column dataframe.</span></h4></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px">In [<!-- -->0<!-- -->]:</div><div style="width:100%;border-radius:2px;position:relative;overflow-x:auto;border:1px solid rgb(207, 207, 207)"><pre class="CodeMirror cm-s-default  CodeMirror-wrap" style="width:100%;overflow-x:auto;line-height:normal;height:auto;font-size:inherit;margin-bottom:0;padding:4px;white-space:pre-wrap;word-wrap:break-word;word-break:normal;border:0;background:white"><div style="margin-left:0"><span class="cm-keyword">import</span><span> </span><span class="cm-variable">datetime</span><span>
</span><span>
</span><span class="cm-comment"># Drop last column</span><span>
</span><span class="cm-variable">soup_df</span><span> </span><span>=</span><span> </span><span class="cm-variable">soup_df</span><span>.</span><span class="cm-variable">drop</span><span>(</span><span class="cm-string">&#x27;Movie&#x27;</span><span>,</span><span> </span><span class="cm-variable">axis</span><span>=</span><span class="cm-number">1</span><span>)</span><span>
</span><span>
</span><span class="cm-comment"># Combine the date and each of the three time columns into three datetime columns</span><span>
</span><span class="cm-variable">soup_df</span><span>[</span><span class="cm-string">&#x27;Start Datetime&#x27;</span><span>]</span><span> </span><span>=</span><span> </span><span class="cm-variable">pd</span><span>.</span><span class="cm-variable">to_datetime</span><span>(</span><span class="cm-variable">soup_df</span><span>[</span><span class="cm-string">&#x27;Date&#x27;</span><span>]</span><span>.</span><span class="cm-variable">apply</span><span>(</span><span class="cm-builtin">str</span><span>)</span><span class="cm-operator">+</span><span class="cm-string">&#x27; &#x27;</span><span class="cm-operator">+</span><span> </span><span class="cm-variable">soup_df</span><span>[</span><span class="cm-string">&#x27;Start Time&#x27;</span><span>]</span><span>)</span><span>
</span><span class="cm-variable">soup_df</span><span>[</span><span class="cm-string">&#x27;Max Datetime&#x27;</span><span>]</span><span> </span><span>=</span><span> </span><span class="cm-variable">pd</span><span>.</span><span class="cm-variable">to_datetime</span><span>(</span><span class="cm-variable">soup_df</span><span>[</span><span class="cm-string">&#x27;Date&#x27;</span><span>]</span><span>.</span><span class="cm-variable">apply</span><span>(</span><span class="cm-builtin">str</span><span>)</span><span class="cm-operator">+</span><span class="cm-string">&#x27; &#x27;</span><span class="cm-operator">+</span><span> </span><span class="cm-variable">soup_df</span><span>[</span><span class="cm-string">&#x27;Max Time&#x27;</span><span>]</span><span>)</span><span>
</span><span class="cm-variable">soup_df</span><span>[</span><span class="cm-string">&#x27;End Datetime&#x27;</span><span>]</span><span> </span><span>=</span><span> </span><span class="cm-variable">pd</span><span>.</span><span class="cm-variable">to_datetime</span><span>(</span><span class="cm-variable">soup_df</span><span>[</span><span class="cm-string">&#x27;Date&#x27;</span><span>]</span><span>.</span><span class="cm-variable">apply</span><span>(</span><span class="cm-builtin">str</span><span>)</span><span class="cm-operator">+</span><span class="cm-string">&#x27; &#x27;</span><span class="cm-operator">+</span><span> </span><span class="cm-variable">soup_df</span><span>[</span><span class="cm-string">&#x27;End Time&#x27;</span><span>]</span><span>)</span><span>
</span><span>
</span><span>
</span><span class="cm-comment"># Drop Time Columns &amp; Date Column</span><span>
</span><span class="cm-variable">soup_df</span><span> </span><span>=</span><span> </span><span class="cm-variable">soup_df</span><span>.</span><span class="cm-variable">drop</span><span>(</span><span class="cm-string">&#x27;Start Time&#x27;</span><span>,</span><span> </span><span class="cm-variable">axis</span><span>=</span><span class="cm-number">1</span><span>)</span><span>
</span><span class="cm-variable">soup_df</span><span> </span><span>=</span><span> </span><span class="cm-variable">soup_df</span><span>.</span><span class="cm-variable">drop</span><span>(</span><span class="cm-string">&#x27;Max Time&#x27;</span><span>,</span><span> </span><span class="cm-variable">axis</span><span>=</span><span class="cm-number">1</span><span>)</span><span>
</span><span class="cm-variable">soup_df</span><span> </span><span>=</span><span> </span><span class="cm-variable">soup_df</span><span>.</span><span class="cm-variable">drop</span><span>(</span><span class="cm-string">&#x27;End Time&#x27;</span><span>,</span><span> </span><span class="cm-variable">axis</span><span>=</span><span class="cm-number">1</span><span>)</span><span>
</span><span class="cm-variable">soup_df</span><span> </span><span>=</span><span> </span><span class="cm-variable">soup_df</span><span>.</span><span class="cm-variable">drop</span><span>(</span><span class="cm-string">&#x27;Date&#x27;</span><span>,</span><span> </span><span class="cm-variable">axis</span><span>=</span><span class="cm-number">1</span><span>)</span><span>
</span><span>
</span><span class="cm-comment"># Rearrange Columns</span><span>
</span><span class="cm-variable">top50_df</span><span> </span><span>=</span><span> </span><span class="cm-variable">soup_df</span><span>[</span><span>[</span><span class="cm-string">&#x27;Rank&#x27;</span><span>,</span><span> </span><span class="cm-string">&#x27;X Class&#x27;</span><span>,</span><span> </span><span class="cm-string">&#x27;Start Datetime&#x27;</span><span>,</span><span> </span><span class="cm-string">&#x27;Max Datetime&#x27;</span><span>,</span><span> </span><span class="cm-string">&#x27;End Datetime&#x27;</span><span>,</span><span> </span><span class="cm-string">&#x27;Region&#x27;</span><span>]</span><span>]</span><span>
</span><span>
</span><span class="cm-variable">display</span><span>(</span><span class="cm-variable">top50_df</span><span>.</span><span class="cm-variable">head</span><span>(</span><span class="cm-number">11</span><span>)</span><span>)</span><span>
</span><span>
</span><span class="cm-variable">display</span><span>(</span><span class="cm-variable">top50_df</span><span>.</span><span class="cm-variable">dtypes</span><span>)</span><span>
</span></div></pre></div></div><div style="display:flex;flex-direction:row;align-items:stretch" cocalc-test="cell-output"><div class="ant-btn ant-btn-default" style="border-color:transparent;font-size:inherit;padding:0;display:flex;flex-direction:column;height:auto"><div style="color:#D84315;min-width:7em;font-family:monospace;text-align:right;padding-right:5px;padding-bottom:2px"></div><div style="flex:1"></div> </div><div style="flex:1;overflow-x:auto;line-height:normal;background-color:#fff;border:0;margin-bottom:0;margin-left:1px" class="cocalc-jupyter-rendered"><div style="margin:5px 0"><div><div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>Rank</th><th>X Class</th><th>Start Datetime</th><th>Max Datetime</th><th>End Datetime</th><th>Region</th></tr></thead><tbody><tr><th>0</th><td>1</td><td>X28+</td><td>2003-11-04 19:29:00</td><td>2003-11-04 19:53:00</td><td>2003-11-04 20:06:00</td><td>486</td></tr><tr><th>1</th><td>2</td><td>X20+</td><td>2001-04-02 21:32:00</td><td>2001-04-02 21:51:00</td><td>2001-04-02 22:03:00</td><td>9393</td></tr><tr><th>2</th><td>3</td><td>X17.2+</td><td>2003-10-28 09:51:00</td><td>2003-10-28 11:10:00</td><td>2003-10-28 11:24:00</td><td>486</td></tr><tr><th>3</th><td>4</td><td>X17+</td><td>2005-09-07 17:17:00</td><td>2005-09-07 17:40:00</td><td>2005-09-07 18:03:00</td><td>808</td></tr><tr><th>4</th><td>5</td><td>X14.4</td><td>2001-04-15 13:19:00</td><td>2001-04-15 13:50:00</td><td>2001-04-15 13:55:00</td><td>9415</td></tr><tr><th>5</th><td>6</td><td>X10</td><td>2003-10-29 20:37:00</td><td>2003-10-29 20:49:00</td><td>2003-10-29 21:01:00</td><td>486</td></tr><tr><th>6</th><td>7</td><td>X9.4</td><td>1997-11-06 11:49:00</td><td>1997-11-06 11:55:00</td><td>1997-11-06 12:01:00</td><td>8100</td></tr><tr><th>7</th><td>8</td><td>X9.3</td><td>2017-09-06 11:53:00</td><td>2017-09-06 12:02:00</td><td>2017-09-06 12:10:00</td><td>2673</td></tr><tr><th>8</th><td>9</td><td>X9</td><td>2006-12-05 10:18:00</td><td>2006-12-05 10:35:00</td><td>2006-12-05 10:45:00</td><td>930</td></tr><tr><th>9</th><td>10</td><td>X8.3</td><td>2003-11-02 17:03:00</td><td>2003-11-02 17:25:00</td><td>2003-11-02 17:39:00</td><td>486</td></tr><tr><th>10</th><td>11</td><td>X8.2</td><td>2017-09-10 15:35:00</td><td>2017-09-10 16:06:00</td><td>2017-09-10 16:31:00</td><td>2673</td></tr></tbody></table>
</div></div></div><div style="white-space:pre-wrap;word-wrap:break-word;font-family:monospace;padding-top:5px;padding-bottom:5px"><span>Rank                       int64
X Class                   object
Start Datetime    datetime64[ns]
Max Datetime      datetime64[ns]
End Datetime      datetime64[ns]
Region                     int64
dtype: object</span></div></div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><h2 id="step-3-scrape-the-nasa-data"><span>Step 3: Scrape the NASA Data</span></h2></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><h4 id="in-this-step-i-scrape-additional-data-about-the-top-50-solar-flares-from-windwaves-type-ii-bursts-and-cmes-using-beautifulsoup-and-save-it-as-a-pandas-dataframe-the-result-is-a-524-row-x-14-column-dataframe-"><span>In this step, I scrape additional data about the Top 50 solar flares from </span><a href="http://www.hcbravo.org/IntroDataSci/misc/waves_type2.html" target="_blank" rel="noopener"><span>Wind/WAVES type II bursts and CMEs</span></a><span> using BeautifulSoup and save it as a Pandas dataframe. The result is a 524 row x 14 column dataframe. </span></h4></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px">In [<!-- -->0<!-- -->]:</div><div style="width:100%;border-radius:2px;position:relative;overflow-x:auto;border:1px solid rgb(207, 207, 207)"><pre class="CodeMirror cm-s-default  CodeMirror-wrap" style="width:100%;overflow-x:auto;line-height:normal;height:auto;font-size:inherit;margin-bottom:0;padding:4px;white-space:pre-wrap;word-wrap:break-word;word-break:normal;border:0;background:white"><div style="margin-left:0"><span class="cm-variable">url</span><span> </span><span>=</span><span> </span><span class="cm-string">&#x27;https://cdaw.gsfc.nasa.gov/CME_list/radio/waves_type2.html&#x27;</span><span>
</span><span class="cm-variable">headers</span><span> </span><span>=</span><span> </span><span>{</span><span class="cm-string">&#x27;User-Agent&#x27;</span><span>:</span><span> </span><span class="cm-string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/94.0.4606.61 Safari/537.36&#x27;</span><span>}</span><span>
</span><span>
</span><span class="cm-comment"># Use requests to get url</span><span>
</span><span class="cm-variable">response</span><span> </span><span>=</span><span> </span><span class="cm-variable">requests</span><span>.</span><span class="cm-variable">get</span><span>(</span><span class="cm-variable">url</span><span>,</span><span> </span><span class="cm-variable">headers</span><span>=</span><span class="cm-variable">headers</span><span>)</span><span>
</span><span>
</span><span class="cm-comment"># Use BeautifulSoup to read &amp; parse the data</span><span>
</span><span class="cm-variable">soup</span><span> </span><span>=</span><span> </span><span class="cm-variable">BeautifulSoup</span><span>(</span><span class="cm-variable">response</span><span>.</span><span class="cm-variable">content</span><span>,</span><span> </span><span class="cm-string">&#x27;html.parser&#x27;</span><span>)</span><span>
</span><span>
</span><span class="cm-comment"># Turn data into string of text</span><span>
</span><span class="cm-variable">text</span><span> </span><span>=</span><span> </span><span class="cm-variable">soup</span><span>.</span><span class="cm-variable">get_text</span><span>(</span><span>)</span><span>
</span><span>
</span><span class="cm-comment"># Split text as a string list item per line</span><span>
</span><span class="cm-variable">text_list</span><span> </span><span>=</span><span> </span><span class="cm-variable">text</span><span>.</span><span class="cm-variable">splitlines</span><span>(</span><span class="cm-number">0</span><span>)</span><span>
</span><span>
</span><span class="cm-comment"># Slice List of text strings to exclude text not in table</span><span>
</span><span class="cm-variable">text_list</span><span> </span><span>=</span><span> </span><span class="cm-variable">text_list</span><span>[</span><span class="cm-number">15</span><span>:</span><span>]</span><span>
</span><span class="cm-variable">text_data</span><span> </span><span>=</span><span> </span><span>[</span><span>]</span><span>
</span><span>
</span><span class="cm-comment"># Iterate over each line of text</span><span>
</span><span class="cm-keyword">for</span><span> </span><span class="cm-variable">line</span><span> </span><span class="cm-keyword">in</span><span> </span><span class="cm-variable">text_list</span><span>:</span><span>
</span><span>    </span><span class="cm-comment"># Split each word into a string, dropping the column with links to the plots</span><span>
</span><span>    </span><span class="cm-variable">row_data</span><span> </span><span>=</span><span> </span><span class="cm-variable">line</span><span>.</span><span class="cm-variable">split</span><span>(</span><span>)</span><span>[</span><span>:</span><span class="cm-number">14</span><span>]</span><span> </span><span>
</span><span>    </span><span class="cm-variable">text_data</span><span>.</span><span class="cm-variable">append</span><span>(</span><span class="cm-variable">row_data</span><span>)</span><span>
</span><span>
</span><span class="cm-variable">columns</span><span>=</span><span>[</span><span class="cm-string">&#x27;start_date&#x27;</span><span>,</span><span class="cm-string">&#x27;start_time&#x27;</span><span>,</span><span> </span><span class="cm-string">&#x27;end_date&#x27;</span><span>,</span><span class="cm-string">&#x27;end_time&#x27;</span><span>,</span><span class="cm-string">&#x27;start_frequency&#x27;</span><span>,</span><span class="cm-string">&#x27;end_frequency&#x27;</span><span>,</span><span class="cm-string">&#x27;flare_location&#x27;</span><span>,</span><span class="cm-string">&#x27;flare_region&#x27;</span><span>,</span><span class="cm-string">&#x27;importance&#x27;</span><span>,</span><span class="cm-string">&#x27;cme_date&#x27;</span><span>,</span><span class="cm-string">&#x27;cme_time&#x27;</span><span>,</span><span class="cm-string">&#x27;cpa&#x27;</span><span>,</span><span> </span><span class="cm-string">&#x27;width&#x27;</span><span>,</span><span class="cm-string">&#x27;speed&#x27;</span><span>]</span><span>
</span><span>
</span><span class="cm-comment"># Create dataframe from text list</span><span>
</span><span class="cm-variable">nasa_df</span><span> </span><span>=</span><span> </span><span class="cm-variable">pd</span><span>.</span><span class="cm-variable">DataFrame</span><span>(</span><span class="cm-variable">text_data</span><span>,</span><span> </span><span class="cm-variable">columns</span><span>=</span><span class="cm-variable">columns</span><span>)</span><span>
</span><span class="cm-variable">nasa_df</span><span> </span><span>=</span><span> </span><span class="cm-variable">nasa_df</span><span>[</span><span>[</span><span class="cm-string">&quot;cme_date&quot;</span><span>,</span><span> </span><span class="cm-string">&quot;cme_time&quot;</span><span>,</span><span> </span><span class="cm-string">&quot;cpa&quot;</span><span>,</span><span> </span><span class="cm-string">&quot;end_date&quot;</span><span>,</span><span> </span><span class="cm-string">&quot;end_frequency&quot;</span><span>,</span><span> </span><span class="cm-string">&quot;end_time&quot;</span><span>,</span><span> </span><span class="cm-string">&quot;flare_location&quot;</span><span>,</span><span> </span><span class="cm-string">&quot;flare_region&quot;</span><span>,</span><span> </span><span class="cm-string">&quot;importance&quot;</span><span>,</span><span> </span><span class="cm-string">&quot;speed&quot;</span><span>,</span><span> </span><span class="cm-string">&quot;start_date&quot;</span><span>,</span><span> </span><span class="cm-string">&quot;start_frequency&quot;</span><span>,</span><span> </span><span class="cm-string">&quot;start_time&quot;</span><span>,</span><span class="cm-string">&quot;width&quot;</span><span>]</span><span>]</span><span>
</span><span>
</span><span class="cm-variable">display</span><span>(</span><span class="cm-variable">nasa_df</span><span>.</span><span class="cm-variable">head</span><span>(</span><span class="cm-number">11</span><span>)</span><span>)</span><span>
</span></div></pre></div></div><div style="display:flex;flex-direction:row;align-items:stretch" cocalc-test="cell-output"><div class="ant-btn ant-btn-default" style="border-color:transparent;font-size:inherit;padding:0;display:flex;flex-direction:column;height:auto"><div style="color:#D84315;min-width:7em;font-family:monospace;text-align:right;padding-right:5px;padding-bottom:2px"></div><div style="flex:1"></div> </div><div style="flex:1;overflow-x:auto;line-height:normal;background-color:#fff;border:0;margin-bottom:0;margin-left:1px" class="cocalc-jupyter-rendered"><div style="margin:5px 0"><div><div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>cme_date</th><th>cme_time</th><th>cpa</th><th>end_date</th><th>end_frequency</th><th>end_time</th><th>flare_location</th><th>flare_region</th><th>importance</th><th>speed</th><th>start_date</th><th>start_frequency</th><th>start_time</th><th>width</th></tr></thead><tbody><tr><th>0</th><td>04/01</td><td>15:18</td><td>74</td><td>04/01</td><td>4000</td><td>14:15</td><td>S25E16</td><td>8026</td><td>M1.3</td><td>312</td><td>1997/04/01</td><td>8000</td><td>14:00</td><td>79</td></tr><tr><th>1</th><td>04/07</td><td>14:27</td><td>Halo</td><td>04/07</td><td>1000</td><td>17:30</td><td>S28E19</td><td>8027</td><td>C6.8</td><td>878</td><td>1997/04/07</td><td>11000</td><td>14:30</td><td>360</td></tr><tr><th>2</th><td>05/12</td><td>05:30</td><td>Halo</td><td>05/14</td><td>80</td><td>16:00</td><td>N21W08</td><td>8038</td><td>C1.3</td><td>464</td><td>1997/05/12</td><td>12000</td><td>05:15</td><td>360</td></tr><tr><th>3</th><td>05/21</td><td>21:00</td><td>263</td><td>05/21</td><td>500</td><td>22:00</td><td>N05W12</td><td>8040</td><td>M1.3</td><td>296</td><td>1997/05/21</td><td>5000</td><td>20:20</td><td>165</td></tr><tr><th>4</th><td>09/23</td><td>22:02</td><td>133</td><td>09/23</td><td>2000</td><td>22:16</td><td>S29E25</td><td>8088</td><td>C1.4</td><td>712</td><td>1997/09/23</td><td>6000</td><td>21:53</td><td>155</td></tr><tr><th>5</th><td>11/03</td><td>05:28</td><td>240</td><td>11/03</td><td>250</td><td>12:00</td><td>S20W13</td><td>8100</td><td>C8.6</td><td>227</td><td>1997/11/03</td><td>14000</td><td>05:15</td><td>109</td></tr><tr><th>6</th><td>11/03</td><td>11:11</td><td>233</td><td>11/03</td><td>5000</td><td>11:30</td><td>S16W21</td><td>8100</td><td>M4.2</td><td>352</td><td>1997/11/03</td><td>14000</td><td>10:30</td><td>122</td></tr><tr><th>7</th><td>11/04</td><td>06:10</td><td>Halo</td><td>11/05</td><td>100</td><td>04:30</td><td>S14W33</td><td>8100</td><td>X2.1</td><td>785</td><td>1997/11/04</td><td>14000</td><td>06:00</td><td>360</td></tr><tr><th>8</th><td>11/06</td><td>12:10</td><td>Halo</td><td>11/07</td><td>100</td><td>08:30</td><td>S18W63</td><td>8100</td><td>X9.4</td><td>1556</td><td>1997/11/06</td><td>14000</td><td>12:20</td><td>360</td></tr><tr><th>9</th><td>11/27</td><td>13:56</td><td>98</td><td>11/27</td><td>7000</td><td>14:00</td><td>N17E63</td><td>8113</td><td>X2.6</td><td>441</td><td>1997/11/27</td><td>14000</td><td>13:30</td><td>91</td></tr><tr><th>10</th><td>12/13</td><td>00:26</td><td>278</td><td>12/12</td><td>8000</td><td>23:20</td><td>N25W52</td><td>8116</td><td>B9.4</td><td>191</td><td>1997/12/12</td><td>14000</td><td>22:45</td><td>73</td></tr></tbody></table>
</div></div></div></div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><h2 id="step-4-tidy-the-nasa-table"><span>Step 4: Tidy the NASA Table</span></h2></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><h4 id="next-i-tidy-the-nasa-data-by-removing-unnecessary-data-coding-missing-observations-properly-as-nan-values-reorganizing-data-from-the-cpa-central-position-angle-and-the-width-cme-width-in-the-sky-plane-columns-since-they-correspond-to-more-than-one-piece-of-information-and-combining-dates-and-times-into-datetime-columns-i-then-convert-the-dataframe-columns-to-their-correct-datatypes-and-organize-the-columns-into-the-same-order-as-the-data-table-from-the-nasa-website-the-result-is-a-522-row-x-13-column-dataframe-"><span>Next, I tidy the Nasa data by removing unnecessary data, coding missing observations properly as NaN values, reorganizing data from the CPA (Central position angle) and the Width (CME width in the sky plane) columns since they correspond to more than one piece of information, and combining dates and times into datetime columns. I then convert the dataframe columns to their correct datatypes and organize the columns into the same order as the data table from the Nasa website. The result is a 522 row x 13 column dataframe. </span></h4></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px">In [<!-- -->0<!-- -->]:</div><div style="width:100%;border-radius:2px;position:relative;overflow-x:auto;border:1px solid rgb(207, 207, 207)"><pre class="CodeMirror cm-s-default  CodeMirror-wrap" style="width:100%;overflow-x:auto;line-height:normal;height:auto;font-size:inherit;margin-bottom:0;padding:4px;white-space:pre-wrap;word-wrap:break-word;word-break:normal;border:0;background:white"><div style="margin-left:0"><span class="cm-comment"># Drop last two empty rows</span><span>
</span><span class="cm-variable">nasa_df</span><span>.</span><span class="cm-variable">drop</span><span>(</span><span class="cm-variable">nasa_df</span><span>.</span><span class="cm-variable">tail</span><span>(</span><span class="cm-number">2</span><span>)</span><span>.</span><span class="cm-variable">index</span><span>,</span><span class="cm-variable">inplace</span><span>=</span><span class="cm-keyword">True</span><span>)</span><span>
</span><span>
</span><span class="cm-comment"># Replace empty data with NaN</span><span>
</span><span class="cm-variable">nasa_df</span><span> </span><span>=</span><span> </span><span class="cm-variable">nasa_df</span><span>.</span><span class="cm-variable">replace</span><span>(</span><span>{</span><span class="cm-string">&#x27;????&#x27;</span><span> </span><span>:</span><span> </span><span class="cm-variable">np</span><span>.</span><span class="cm-variable">nan</span><span>,</span><span> </span><span class="cm-string">&#x27;---&#x27;</span><span> </span><span>:</span><span> </span><span class="cm-variable">np</span><span>.</span><span class="cm-variable">nan</span><span>,</span><span> </span><span class="cm-string">&#x27;-----&#x27;</span><span> </span><span>:</span><span> </span><span class="cm-variable">np</span><span>.</span><span class="cm-variable">nan</span><span>,</span><span> </span><span class="cm-string">&#x27;----&#x27;</span><span> </span><span>:</span><span> </span><span class="cm-variable">np</span><span>.</span><span class="cm-variable">nan</span><span>,</span><span> </span><span class="cm-string">&#x27;------&#x27;</span><span> </span><span class="cm-error">\</span><span>
</span><span>                                 </span><span>:</span><span> </span><span class="cm-variable">np</span><span>.</span><span class="cm-variable">nan</span><span>,</span><span> </span><span class="cm-string">&#x27;--/--&#x27;</span><span> </span><span>:</span><span> </span><span class="cm-variable">np</span><span>.</span><span class="cm-variable">nan</span><span>,</span><span> </span><span class="cm-string">&#x27;--:--&#x27;</span><span> </span><span>:</span><span> </span><span class="cm-variable">np</span><span>.</span><span class="cm-variable">nan</span><span>,</span><span> </span><span class="cm-string">&#x27;back&#x27;</span><span> </span><span>:</span><span> </span><span class="cm-string">&#x27;BACK&#x27;</span><span>,</span><span> </span><span class="cm-error">\</span><span>
</span><span>                                 </span><span class="cm-string">&#x27;Back&#x27;</span><span> </span><span>:</span><span> </span><span class="cm-string">&#x27;BACK&#x27;</span><span>,</span><span> </span><span class="cm-string">&#x27;DSF&#x27;</span><span> </span><span>:</span><span> </span><span class="cm-string">&#x27;FILA&#x27;</span><span>}</span><span>)</span><span>
</span><span>
</span><span class="cm-comment"># Create new column that indicates if a row corresponds to a halo flare or not</span><span>
</span><span class="cm-variable">halo_list</span><span> </span><span>=</span><span> </span><span>[</span><span class="cm-keyword">True</span><span> </span><span class="cm-keyword">if</span><span> </span><span class="cm-variable">i</span><span> </span><span class="cm-operator">==</span><span> </span><span class="cm-string">&#x27;Halo&#x27;</span><span> </span><span class="cm-keyword">else</span><span> </span><span class="cm-keyword">False</span><span> </span><span class="cm-keyword">for</span><span> </span><span class="cm-variable">i</span><span> </span><span class="cm-keyword">in</span><span> </span><span class="cm-variable">nasa_df</span><span>[</span><span class="cm-string">&#x27;cpa&#x27;</span><span>]</span><span>.</span><span class="cm-variable">tolist</span><span>(</span><span>)</span><span>]</span><span>
</span><span class="cm-variable">nasa_df</span><span>[</span><span class="cm-string">&#x27;is_flare&#x27;</span><span>]</span><span> </span><span>=</span><span> </span><span class="cm-variable">halo_list</span><span>
</span><span>
</span><span class="cm-comment"># Replace Halo entries in the cme_angle column as np.nan</span><span>
</span><span class="cm-variable">nasa_df</span><span>[</span><span class="cm-string">&quot;cpa&quot;</span><span>]</span><span>.</span><span class="cm-variable">replace</span><span>(</span><span>{</span><span class="cm-string">&quot;Halo&quot;</span><span>:</span><span> </span><span class="cm-variable">np</span><span>.</span><span class="cm-variable">nan</span><span>}</span><span>,</span><span> </span><span class="cm-variable">inplace</span><span>=</span><span class="cm-keyword">True</span><span>)</span><span>
</span><span>
</span><span class="cm-comment"># Create a new column that indicates if width is given as a lower bound</span><span>
</span><span class="cm-variable">width_list</span><span> </span><span>=</span><span> </span><span class="cm-variable">nasa_df</span><span>[</span><span class="cm-string">&#x27;width&#x27;</span><span>]</span><span>.</span><span class="cm-variable">astype</span><span>(</span><span class="cm-builtin">str</span><span>)</span><span>.</span><span class="cm-variable">tolist</span><span>(</span><span>)</span><span>
</span><span class="cm-variable">lower_bound_list</span><span> </span><span>=</span><span> </span><span>[</span><span class="cm-keyword">True</span><span> </span><span class="cm-keyword">if</span><span> </span><span class="cm-string">&quot;&gt;&quot;</span><span> </span><span class="cm-keyword">in</span><span> </span><span class="cm-variable">i</span><span> </span><span class="cm-keyword">else</span><span> </span><span class="cm-keyword">False</span><span> </span><span class="cm-keyword">for</span><span> </span><span class="cm-variable">i</span><span> </span><span class="cm-keyword">in</span><span> </span><span class="cm-variable">width_list</span><span>]</span><span>
</span><span class="cm-variable">nasa_df</span><span>[</span><span class="cm-string">&#x27;width_lower_bound&#x27;</span><span>]</span><span> </span><span>=</span><span> </span><span class="cm-variable">lower_bound_list</span><span>
</span><span>
</span><span class="cm-comment"># Remove any non-numeric part (&gt;) of the width column</span><span>
</span><span class="cm-variable">num_width_list</span><span> </span><span>=</span><span> </span><span>[</span><span class="cm-variable">i</span><span>.</span><span class="cm-variable">replace</span><span>(</span><span class="cm-string">&#x27;&gt;&#x27;</span><span>,</span><span> </span><span class="cm-string">&#x27;&#x27;</span><span>)</span><span> </span><span class="cm-keyword">if</span><span> </span><span class="cm-string">&quot;&gt;&quot;</span><span> </span><span class="cm-keyword">in</span><span> </span><span class="cm-variable">i</span><span> </span><span class="cm-keyword">else</span><span> </span><span class="cm-variable">i</span><span> </span><span class="cm-keyword">for</span><span> </span><span class="cm-variable">i</span><span> </span><span class="cm-keyword">in</span><span> </span><span class="cm-variable">width_list</span><span>]</span><span>
</span><span class="cm-variable">nasa_df</span><span>[</span><span class="cm-string">&#x27;width&#x27;</span><span>]</span><span> </span><span>=</span><span> </span><span class="cm-variable">num_width_list</span><span>
</span><span class="cm-variable">nasa_df</span><span>[</span><span class="cm-string">&#x27;width&#x27;</span><span>]</span><span>=</span><span> </span><span class="cm-variable">nasa_df</span><span>[</span><span class="cm-string">&#x27;width&#x27;</span><span>]</span><span>.</span><span class="cm-builtin">str</span><span>.</span><span class="cm-variable">replace</span><span>(</span><span class="cm-string">r&#x27;\D+&#x27;</span><span>,</span><span class="cm-string">&#x27;&#x27;</span><span>,</span><span> </span><span class="cm-variable">regex</span><span>=</span><span class="cm-keyword">True</span><span>)</span><span>
</span><span>
</span></div></pre></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px">In [<!-- -->0<!-- -->]:</div><div style="width:100%;border-radius:2px;position:relative;overflow-x:auto;border:1px solid rgb(207, 207, 207)"><pre class="CodeMirror cm-s-default  CodeMirror-wrap" style="width:100%;overflow-x:auto;line-height:normal;height:auto;font-size:inherit;margin-bottom:0;padding:4px;white-space:pre-wrap;word-wrap:break-word;word-break:normal;border:0;background:white"><div style="margin-left:0"><span class="cm-comment"># Combine date and time columns for start time</span><span>
</span><span class="cm-variable">nasa_df</span><span>[</span><span class="cm-string">&#x27;start_datetime&#x27;</span><span>]</span><span> </span><span>=</span><span> </span><span class="cm-variable">pd</span><span>.</span><span class="cm-variable">to_datetime</span><span>(</span><span class="cm-variable">nasa_df</span><span>[</span><span class="cm-string">&#x27;start_date&#x27;</span><span>]</span><span>.</span><span class="cm-variable">apply</span><span>(</span><span class="cm-builtin">str</span><span>)</span><span class="cm-operator">+</span><span class="cm-string">&#x27; &#x27;</span><span class="cm-operator">+</span><span> </span><span class="cm-variable">nasa_df</span><span>[</span><span class="cm-string">&#x27;start_time&#x27;</span><span>]</span><span>)</span><span>
</span><span>
</span><span class="cm-comment"># Scrape year from Start time (for end time &amp; cme time)</span><span>
</span><span class="cm-variable">year</span><span> </span><span>=</span><span> </span><span class="cm-variable">pd</span><span>.</span><span class="cm-variable">DatetimeIndex</span><span>(</span><span class="cm-variable">nasa_df</span><span>[</span><span class="cm-string">&#x27;start_datetime&#x27;</span><span>]</span><span>)</span><span>.</span><span class="cm-variable">year</span><span>
</span><span>
</span><span class="cm-comment"># Replace out of bounds end times (24:00) with in bounds (23:59)</span><span>
</span><span class="cm-variable">nasa_df</span><span>[</span><span class="cm-string">&#x27;end_time&#x27;</span><span>]</span><span> </span><span>=</span><span> </span><span class="cm-variable">nasa_df</span><span>.</span><span class="cm-variable">end_time</span><span>.</span><span class="cm-variable">replace</span><span>(</span><span class="cm-string">&#x27;24:00&#x27;</span><span>,</span><span class="cm-string">&#x27;23:59&#x27;</span><span>)</span><span>
</span><span>
</span><span class="cm-comment"># Combine date and time columns for end time</span><span>
</span><span class="cm-variable">nasa_df</span><span>[</span><span class="cm-string">&#x27;end_datetime&#x27;</span><span>]</span><span> </span><span>=</span><span> </span><span class="cm-variable">pd</span><span>.</span><span class="cm-variable">to_datetime</span><span>(</span><span class="cm-variable">year</span><span>.</span><span class="cm-variable">astype</span><span>(</span><span class="cm-builtin">str</span><span>)</span><span class="cm-operator">+</span><span class="cm-string">&quot;/&quot;</span><span class="cm-operator">+</span><span class="cm-variable">nasa_df</span><span>[</span><span class="cm-string">&#x27;end_date&#x27;</span><span>]</span><span>.</span><span class="cm-variable">apply</span><span>(</span><span class="cm-builtin">str</span><span>)</span><span class="cm-operator">+</span><span class="cm-string">&#x27; &#x27;</span><span class="cm-operator">+</span><span> </span><span class="cm-variable">nasa_df</span><span>[</span><span class="cm-string">&#x27;end_time&#x27;</span><span>]</span><span>)</span><span>
</span><span>
</span><span class="cm-comment"># Combine date and time columns for cme time</span><span>
</span><span class="cm-variable">nasa_df</span><span>[</span><span class="cm-string">&#x27;cme_datetime&#x27;</span><span>]</span><span> </span><span>=</span><span> </span><span class="cm-variable">pd</span><span>.</span><span class="cm-variable">to_datetime</span><span>(</span><span class="cm-variable">year</span><span>.</span><span class="cm-variable">astype</span><span>(</span><span class="cm-builtin">str</span><span>)</span><span class="cm-operator">+</span><span class="cm-string">&quot;/&quot;</span><span class="cm-operator">+</span><span class="cm-variable">nasa_df</span><span>[</span><span class="cm-string">&#x27;cme_date&#x27;</span><span>]</span><span>.</span><span class="cm-variable">apply</span><span>(</span><span class="cm-builtin">str</span><span>)</span><span class="cm-operator">+</span><span class="cm-string">&#x27; &#x27;</span><span class="cm-operator">+</span><span> </span><span class="cm-variable">nasa_df</span><span>[</span><span class="cm-string">&#x27;cme_time&#x27;</span><span>]</span><span>)</span><span>
</span><span>
</span><span class="cm-comment"># Drop separate time and date columns</span><span>
</span><span class="cm-variable">nasa_df</span><span> </span><span>=</span><span> </span><span class="cm-variable">nasa_df</span><span>.</span><span class="cm-variable">drop</span><span>(</span><span>[</span><span class="cm-string">&#x27;cme_date&#x27;</span><span>,</span><span> </span><span class="cm-string">&#x27;cme_time&#x27;</span><span>,</span><span> </span><span class="cm-string">&#x27;end_date&#x27;</span><span>,</span><span> </span><span class="cm-string">&#x27;end_time&#x27;</span><span>,</span><span> </span><span class="cm-string">&#x27;start_date&#x27;</span><span>,</span><span> </span><span class="cm-string">&#x27;start_time&#x27;</span><span>]</span><span>,</span><span> </span><span class="cm-variable">axis</span><span> </span><span>=</span><span> </span><span class="cm-number">1</span><span>)</span><span>
</span><span>
</span><span class="cm-comment"># Convert columns to correct data types</span><span>
</span><span class="cm-variable">dtype_cols</span><span> </span><span>=</span><span> </span><span>[</span><span class="cm-string">&#x27;width&#x27;</span><span>,</span><span> </span><span class="cm-string">&#x27;cpa&#x27;</span><span>,</span><span> </span><span class="cm-string">&#x27;start_frequency&#x27;</span><span>,</span><span> </span><span class="cm-string">&#x27;end_frequency&#x27;</span><span>,</span><span> </span><span class="cm-string">&#x27;speed&#x27;</span><span>]</span><span>
</span><span class="cm-variable">nasa_df</span><span>[</span><span class="cm-variable">dtype_cols</span><span>]</span><span> </span><span>=</span><span> </span><span class="cm-variable">nasa_df</span><span>[</span><span class="cm-variable">dtype_cols</span><span>]</span><span>.</span><span class="cm-variable">apply</span><span>(</span><span class="cm-variable">pd</span><span>.</span><span class="cm-variable">to_numeric</span><span>,</span><span> </span><span class="cm-variable">axis</span><span>=</span><span class="cm-number">1</span><span>)</span><span>
</span><span>
</span><span class="cm-comment"># Display columns in correct order</span><span>
</span><span class="cm-variable">nasa_df</span><span> </span><span>=</span><span> </span><span class="cm-variable">nasa_df</span><span>[</span><span>[</span><span class="cm-string">&#x27;start_datetime&#x27;</span><span>,</span><span> </span><span class="cm-string">&#x27;end_datetime&#x27;</span><span>,</span><span> </span><span class="cm-string">&#x27;start_frequency&#x27;</span><span>,</span><span> </span><span class="cm-string">&#x27;end_frequency&#x27;</span><span>,</span><span> </span><span class="cm-string">&#x27;flare_location&#x27;</span><span>,</span><span> </span><span class="cm-string">&#x27;flare_region&#x27;</span><span>,</span><span> </span><span class="cm-string">&#x27;importance&#x27;</span><span>,</span><span> </span><span class="cm-string">&#x27;cme_datetime&#x27;</span><span>,</span><span> </span><span class="cm-string">&#x27;cpa&#x27;</span><span>,</span><span> </span><span class="cm-string">&#x27;width&#x27;</span><span>,</span><span> </span><span class="cm-string">&#x27;speed&#x27;</span><span>,</span><span> </span><span class="cm-string">&#x27;is_flare&#x27;</span><span>,</span><span> </span><span class="cm-string">&#x27;width_lower_bound&#x27;</span><span>]</span><span>]</span><span>
</span><span class="cm-variable">nasa_is_flare</span><span> </span><span>=</span><span> </span><span class="cm-variable">nasa_df</span><span>[</span><span>[</span><span class="cm-string">&#x27;is_flare&#x27;</span><span>,</span><span> </span><span class="cm-string">&#x27;importance&#x27;</span><span>]</span><span>]</span><span>
</span><span>
</span><span>
</span><span class="cm-variable">display</span><span>(</span><span class="cm-variable">nasa_df</span><span>.</span><span class="cm-variable">head</span><span>(</span><span class="cm-number">11</span><span>)</span><span>)</span><span>
</span><span class="cm-variable">display</span><span>(</span><span class="cm-variable">nasa_df</span><span>.</span><span class="cm-variable">dtypes</span><span>)</span><span>
</span></div></pre></div></div><div style="display:flex;flex-direction:row;align-items:stretch" cocalc-test="cell-output"><div class="ant-btn ant-btn-default" style="border-color:transparent;font-size:inherit;padding:0;display:flex;flex-direction:column;height:auto"><div style="color:#D84315;min-width:7em;font-family:monospace;text-align:right;padding-right:5px;padding-bottom:2px"></div><div style="flex:1"></div> </div><div style="flex:1;overflow-x:auto;line-height:normal;background-color:#fff;border:0;margin-bottom:0;margin-left:1px" class="cocalc-jupyter-rendered"><div style="margin:5px 0"><div><div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>start_datetime</th><th>end_datetime</th><th>start_frequency</th><th>end_frequency</th><th>flare_location</th><th>flare_region</th><th>importance</th><th>cme_datetime</th><th>cpa</th><th>width</th><th>speed</th><th>is_flare</th><th>width_lower_bound</th></tr></thead><tbody><tr><th>0</th><td>1997-04-01 14:00:00</td><td>1997-04-01 14:15:00</td><td>8000.0</td><td>4000.0</td><td>S25E16</td><td>8026</td><td>M1.3</td><td>1997-04-01 15:18:00</td><td>74.0</td><td>79.0</td><td>312.0</td><td>False</td><td>False</td></tr><tr><th>1</th><td>1997-04-07 14:30:00</td><td>1997-04-07 17:30:00</td><td>11000.0</td><td>1000.0</td><td>S28E19</td><td>8027</td><td>C6.8</td><td>1997-04-07 14:27:00</td><td>NaN</td><td>360.0</td><td>878.0</td><td>True</td><td>False</td></tr><tr><th>2</th><td>1997-05-12 05:15:00</td><td>1997-05-14 16:00:00</td><td>12000.0</td><td>80.0</td><td>N21W08</td><td>8038</td><td>C1.3</td><td>1997-05-12 05:30:00</td><td>NaN</td><td>360.0</td><td>464.0</td><td>True</td><td>False</td></tr><tr><th>3</th><td>1997-05-21 20:20:00</td><td>1997-05-21 22:00:00</td><td>5000.0</td><td>500.0</td><td>N05W12</td><td>8040</td><td>M1.3</td><td>1997-05-21 21:00:00</td><td>263.0</td><td>165.0</td><td>296.0</td><td>False</td><td>False</td></tr><tr><th>4</th><td>1997-09-23 21:53:00</td><td>1997-09-23 22:16:00</td><td>6000.0</td><td>2000.0</td><td>S29E25</td><td>8088</td><td>C1.4</td><td>1997-09-23 22:02:00</td><td>133.0</td><td>155.0</td><td>712.0</td><td>False</td><td>False</td></tr><tr><th>5</th><td>1997-11-03 05:15:00</td><td>1997-11-03 12:00:00</td><td>14000.0</td><td>250.0</td><td>S20W13</td><td>8100</td><td>C8.6</td><td>1997-11-03 05:28:00</td><td>240.0</td><td>109.0</td><td>227.0</td><td>False</td><td>False</td></tr><tr><th>6</th><td>1997-11-03 10:30:00</td><td>1997-11-03 11:30:00</td><td>14000.0</td><td>5000.0</td><td>S16W21</td><td>8100</td><td>M4.2</td><td>1997-11-03 11:11:00</td><td>233.0</td><td>122.0</td><td>352.0</td><td>False</td><td>False</td></tr><tr><th>7</th><td>1997-11-04 06:00:00</td><td>1997-11-05 04:30:00</td><td>14000.0</td><td>100.0</td><td>S14W33</td><td>8100</td><td>X2.1</td><td>1997-11-04 06:10:00</td><td>NaN</td><td>360.0</td><td>785.0</td><td>True</td><td>False</td></tr><tr><th>8</th><td>1997-11-06 12:20:00</td><td>1997-11-07 08:30:00</td><td>14000.0</td><td>100.0</td><td>S18W63</td><td>8100</td><td>X9.4</td><td>1997-11-06 12:10:00</td><td>NaN</td><td>360.0</td><td>1556.0</td><td>True</td><td>False</td></tr><tr><th>9</th><td>1997-11-27 13:30:00</td><td>1997-11-27 14:00:00</td><td>14000.0</td><td>7000.0</td><td>N17E63</td><td>8113</td><td>X2.6</td><td>1997-11-27 13:56:00</td><td>98.0</td><td>91.0</td><td>441.0</td><td>False</td><td>False</td></tr><tr><th>10</th><td>1997-12-12 22:45:00</td><td>1997-12-12 23:20:00</td><td>14000.0</td><td>8000.0</td><td>N25W52</td><td>8116</td><td>B9.4</td><td>1997-12-13 00:26:00</td><td>278.0</td><td>73.0</td><td>191.0</td><td>False</td><td>False</td></tr></tbody></table>
</div></div></div><div style="white-space:pre-wrap;word-wrap:break-word;font-family:monospace;padding-top:5px;padding-bottom:5px"><span>start_datetime       datetime64[ns]
end_datetime         datetime64[ns]
start_frequency             float64
end_frequency               float64
flare_location               object
flare_region                 object
importance                   object
cme_datetime         datetime64[ns]
cpa                         float64
width                       float64
speed                       float64
is_flare                       bool
width_lower_bound              bool
dtype: object</span></div></div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><h2 id="step-5-data-analysis"><span>Step 5: Data Analysis</span></h2><p><span>Finally, I compare the solar flare data obtained from </span><a href="http://SpaceWeatherLive.com" target="_blank" rel="noopener"><span>SpaceWeatherLive.com</span></a><span> and NASA to determine the consistency and trends between the two websites. </span></p></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><h3 id="replication"><span><u>Replication</u></span></h3></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><h3 id="the-top-50-solar-flares-from-the-nasa-data-are-not-entirely-the-same-as-from-the-space-weather-live-data-only-29-out-of-the-top-50-solar-flares-in-the-nasa-data-are-the-same-as-the-space-weather-live-data"><span>The top 50 solar flares from the nasa data are not entirely the same as from the Space Weather Live data. Only 29 out of the top 50 solar flares in the Nasa data are the same as the Space Weather Live data.</span></h3></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px">In [<!-- -->0<!-- -->]:</div><div style="width:100%;border-radius:2px;position:relative;overflow-x:auto;border:1px solid rgb(207, 207, 207)"><pre class="CodeMirror cm-s-default  CodeMirror-wrap" style="width:100%;overflow-x:auto;line-height:normal;height:auto;font-size:inherit;margin-bottom:0;padding:4px;white-space:pre-wrap;word-wrap:break-word;word-break:normal;border:0;background:white"><div style="margin-left:0"><span class="cm-comment"># Divide X Class by letter and number</span><span>
</span><span class="cm-variable">nasa_df</span><span>[</span><span class="cm-string">&#x27;firstcol&#x27;</span><span>]</span><span> </span><span>=</span><span> </span><span class="cm-variable">nasa_df</span><span>[</span><span class="cm-string">&#x27;importance&#x27;</span><span>]</span><span>.</span><span class="cm-builtin">str</span><span>.</span><span class="cm-variable">extract</span><span>(</span><span class="cm-string">r&#x27;([A-Za]+)&#x27;</span><span>,</span><span> </span><span class="cm-variable">expand</span><span> </span><span>=</span><span> </span><span class="cm-keyword">True</span><span>)</span><span>
</span><span class="cm-variable">nasa_df</span><span>[</span><span class="cm-string">&#x27;secondcol&#x27;</span><span>]</span><span> </span><span>=</span><span> </span><span class="cm-variable">nasa_df</span><span>[</span><span class="cm-string">&#x27;importance&#x27;</span><span>]</span><span>.</span><span class="cm-builtin">str</span><span>.</span><span class="cm-variable">extract</span><span>(</span><span class="cm-string">r&#x27;(\d+\.?\d*)&#x27;</span><span>,</span><span> </span><span class="cm-variable">expand</span><span> </span><span>=</span><span> </span><span class="cm-keyword">True</span><span>)</span><span>
</span><span>
</span><span class="cm-comment"># Sort X Class by letter and number</span><span>
</span><span class="cm-variable">nasa_df</span><span>[</span><span class="cm-string">&#x27;secondcol&#x27;</span><span>]</span><span>=</span><span> </span><span class="cm-variable">nasa_df</span><span>[</span><span class="cm-string">&#x27;secondcol&#x27;</span><span>]</span><span>.</span><span class="cm-builtin">str</span><span>.</span><span class="cm-variable">ljust</span><span>(</span><span class="cm-number">3</span><span>,</span><span> </span><span class="cm-variable">fillchar</span><span>=</span><span class="cm-string">&#x27;0&#x27;</span><span>)</span><span>
</span><span class="cm-variable">nasa_df</span><span>[</span><span class="cm-string">&#x27;secondcol&#x27;</span><span>]</span><span> </span><span>=</span><span> </span><span class="cm-variable">pd</span><span>.</span><span class="cm-variable">to_numeric</span><span>(</span><span class="cm-variable">nasa_df</span><span>[</span><span class="cm-string">&#x27;secondcol&#x27;</span><span>]</span><span>)</span><span>
</span><span class="cm-variable">nasa_df</span><span> </span><span>=</span><span> </span><span class="cm-variable">nasa_df</span><span>.</span><span class="cm-variable">sort_values</span><span>(</span><span class="cm-variable">by</span><span>=</span><span>[</span><span class="cm-string">&#x27;firstcol&#x27;</span><span>,</span><span> </span><span class="cm-string">&#x27;secondcol&#x27;</span><span>]</span><span>,</span><span> </span><span class="cm-variable">ascending</span><span>=</span><span class="cm-keyword">False</span><span>)</span><span>
</span><span>
</span><span class="cm-comment"># Drop unnecessary columns</span><span>
</span><span class="cm-variable">nasa_copy</span><span> </span><span>=</span><span> </span><span class="cm-variable">nasa_df</span><span>.</span><span class="cm-variable">copy</span><span>(</span><span>)</span><span>
</span><span class="cm-variable">nasa_df</span><span> </span><span>=</span><span> </span><span class="cm-variable">nasa_df</span><span>.</span><span class="cm-variable">drop</span><span>(</span><span>[</span><span class="cm-string">&quot;firstcol&quot;</span><span>,</span><span class="cm-string">&quot;secondcol&quot;</span><span>,</span><span class="cm-string">&quot;start_frequency&quot;</span><span>,</span><span class="cm-string">&quot;end_frequency&quot;</span><span>,</span><span class="cm-string">&quot;flare_location&quot;</span><span>,</span><span class="cm-string">&quot;cpa&quot;</span><span>,</span><span> </span><span class="cm-string">&quot;width&quot;</span><span>,</span><span> </span><span class="cm-string">&quot;speed&quot;</span><span>,</span><span> </span><span class="cm-string">&quot;is_flare&quot;</span><span>,</span><span> </span><span class="cm-string">&quot;width_lower_bound&quot;</span><span>]</span><span>,</span><span> </span><span class="cm-variable">axis</span><span>=</span><span class="cm-number">1</span><span>)</span><span>
</span><span>
</span><span class="cm-comment"># Rename columns &amp; change order to Top 50 Solar Flare Data column names</span><span>
</span><span class="cm-variable">nasa_df</span><span> </span><span>=</span><span> </span><span class="cm-variable">nasa_df</span><span>.</span><span class="cm-variable">rename</span><span>(</span><span class="cm-variable">columns</span><span>=</span><span>{</span><span class="cm-string">&#x27;start_datetime&#x27;</span><span>:</span><span class="cm-string">&#x27;Start&#x27;</span><span>,</span><span> </span><span class="cm-string">&#x27;end_datetime&#x27;</span><span>:</span><span class="cm-string">&#x27;End&#x27;</span><span>,</span><span> </span><span class="cm-string">&#x27;flare_region&#x27;</span><span>:</span><span class="cm-string">&#x27;Region&#x27;</span><span>,</span><span> </span><span class="cm-string">&#x27;importance&#x27;</span><span>:</span><span class="cm-string">&#x27;X Class&#x27;</span><span>,</span><span class="cm-string">&#x27;cme_datetime&#x27;</span><span>:</span><span class="cm-string">&#x27;Maximum&#x27;</span><span>}</span><span>)</span><span>
</span><span class="cm-variable">nasa_df</span><span> </span><span>=</span><span> </span><span class="cm-variable">nasa_df</span><span>[</span><span>[</span><span class="cm-string">&#x27;X Class&#x27;</span><span>,</span><span> </span><span class="cm-string">&#x27;Start&#x27;</span><span>,</span><span> </span><span class="cm-string">&#x27;Maximum&#x27;</span><span>,</span><span> </span><span class="cm-string">&#x27;End&#x27;</span><span>,</span><span> </span><span class="cm-string">&#x27;Region&#x27;</span><span>]</span><span>]</span><span>
</span><span>
</span><span class="cm-comment"># Select top 50 Nasa Solar Flares</span><span>
</span><span class="cm-variable">nasa_top50_df</span><span> </span><span>=</span><span> </span><span class="cm-variable">nasa_df</span><span>.</span><span class="cm-variable">head</span><span>(</span><span class="cm-number">50</span><span>)</span><span>
</span><span class="cm-variable">display</span><span>(</span><span class="cm-variable">nasa_top50_df</span><span>)</span><span>
</span><span>
</span><span class="cm-comment"># Rename Top 50 columns to be the same as Nasa Top 50 columns</span><span>
</span><span class="cm-variable">top50_df</span><span> </span><span>=</span><span> </span><span class="cm-variable">top50_df</span><span>.</span><span class="cm-variable">rename</span><span>(</span><span class="cm-variable">columns</span><span>=</span><span>{</span><span class="cm-string">&#x27;Start Datetime&#x27;</span><span>:</span><span class="cm-string">&#x27;Start&#x27;</span><span>,</span><span> </span><span class="cm-string">&#x27;End Datetime&#x27;</span><span>:</span><span class="cm-string">&#x27;End&#x27;</span><span>,</span><span class="cm-string">&#x27;Max Datetime&#x27;</span><span>:</span><span class="cm-string">&#x27;Maximum&#x27;</span><span>}</span><span>)</span><span>
</span><span>
</span><span class="cm-comment"># Determine overlap of Nasa top 50 and Space Weather Live top 50</span><span>
</span><span class="cm-variable">real_top50</span><span> </span><span>=</span><span> </span><span class="cm-variable">nasa_df</span><span>.</span><span class="cm-variable">loc</span><span>[</span><span class="cm-variable">nasa_df</span><span>[</span><span class="cm-string">&#x27;X Class&#x27;</span><span>]</span><span>.</span><span class="cm-variable">isin</span><span>(</span><span class="cm-variable">top50_df</span><span>[</span><span class="cm-string">&#x27;X Class&#x27;</span><span>]</span><span>)</span><span>]</span><span>
</span><span class="cm-variable">display</span><span>(</span><span class="cm-variable">real_top50</span><span>)</span><span>
</span><span class="cm-builtin">print</span><span>(</span><span class="cm-string">&quot;Total number of exact same solar flares between Space Weather Live and NASA data: &quot;</span><span>,</span><span> </span><span class="cm-builtin">len</span><span>(</span><span class="cm-variable">real_top50</span><span>)</span><span>)</span><span>
</span></div></pre></div></div><div style="display:flex;flex-direction:row;align-items:stretch" cocalc-test="cell-output"><div class="ant-btn ant-btn-default" style="border-color:transparent;font-size:inherit;padding:0;display:flex;flex-direction:column;height:auto"><div style="color:#D84315;min-width:7em;font-family:monospace;text-align:right;padding-right:5px;padding-bottom:2px"></div><div style="flex:1"></div> </div><div style="flex:1;overflow-x:auto;line-height:normal;background-color:#fff;border:0;margin-bottom:0;margin-left:1px" class="cocalc-jupyter-rendered"><div style="margin:5px 0"><div><div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>X Class</th><th>Start</th><th>Maximum</th><th>End</th><th>Region</th></tr></thead><tbody><tr><th>240</th><td>X28.</td><td>2003-11-04 20:00:00</td><td>2003-11-04 19:54:00</td><td>2003-11-04 23:59:00</td><td>10486</td></tr><tr><th>117</th><td>X20.</td><td>2001-04-02 22:05:00</td><td>2001-04-02 22:06:00</td><td>2001-04-03 02:30:00</td><td>9393</td></tr><tr><th>233</th><td>X17.</td><td>2003-10-28 11:10:00</td><td>2003-10-28 11:30:00</td><td>2003-10-29 23:59:00</td><td>10486</td></tr><tr><th>126</th><td>X14.</td><td>2001-04-15 14:05:00</td><td>2001-04-15 14:06:00</td><td>2001-04-16 13:00:00</td><td>9415</td></tr><tr><th>234</th><td>X10.</td><td>2003-10-29 20:55:00</td><td>2003-10-29 20:54:00</td><td>2003-10-29 23:59:00</td><td>10486</td></tr><tr><th>8</th><td>X9.4</td><td>1997-11-06 12:20:00</td><td>1997-11-06 12:10:00</td><td>1997-11-07 08:30:00</td><td>8100</td></tr><tr><th>514</th><td>X9.3</td><td>2017-09-06 12:05:00</td><td>2017-09-06 12:24:00</td><td>2017-09-07 08:00:00</td><td>12673</td></tr><tr><th>328</th><td>X9.0</td><td>2006-12-05 10:50:00</td><td>NaT</td><td>2006-12-05 20:00:00</td><td>10930</td></tr><tr><th>237</th><td>X8.3</td><td>2003-11-02 17:30:00</td><td>2003-11-02 17:30:00</td><td>2003-11-03 01:00:00</td><td>10486</td></tr><tr><th>515</th><td>X8.3</td><td>2017-09-10 16:02:00</td><td>2017-09-10 16:00:00</td><td>2017-09-11 06:50:00</td><td>NaN</td></tr><tr><th>288</th><td>X7.1</td><td>2005-01-20 07:15:00</td><td>2005-01-20 06:54:00</td><td>2005-01-20 16:30:00</td><td>10720</td></tr><tr><th>359</th><td>X6.9</td><td>2011-08-09 08:20:00</td><td>2011-08-09 08:12:00</td><td>2011-08-09 08:35:00</td><td>11263</td></tr><tr><th>331</th><td>X6.5</td><td>2006-12-06 19:00:00</td><td>NaT</td><td>2006-12-08 23:59:00</td><td>10930</td></tr><tr><th>317</th><td>X6.2</td><td>2005-09-09 19:45:00</td><td>2005-09-09 19:48:00</td><td>2005-09-09 22:00:00</td><td>10808</td></tr><tr><th>82</th><td>X5.7</td><td>2000-07-14 10:30:00</td><td>2000-07-14 10:54:00</td><td>2000-07-15 14:30:00</td><td>9077</td></tr><tr><th>121</th><td>X5.6</td><td>2001-04-06 19:35:00</td><td>2001-04-06 19:30:00</td><td>2001-04-07 01:50:00</td><td>9415</td></tr><tr><th>375</th><td>X5.4</td><td>2012-03-07 01:00:00</td><td>2012-03-07 00:24:00</td><td>2012-03-08 19:00:00</td><td>11429</td></tr><tr><th>135</th><td>X5.3</td><td>2001-08-25 16:50:00</td><td>2001-08-25 16:50:00</td><td>2001-08-25 23:00:00</td><td>9591</td></tr><tr><th>443</th><td>X4.9</td><td>2014-02-25 00:56:00</td><td>2014-02-25 01:25:00</td><td>2014-02-25 11:28:00</td><td>11990</td></tr><tr><th>193</th><td>X4.8</td><td>2002-07-23 00:50:00</td><td>2002-07-23 00:42:00</td><td>2002-07-23 04:00:00</td><td>10039</td></tr><tr><th>104</th><td>X4.0</td><td>2000-11-26 17:00:00</td><td>2000-11-26 17:06:00</td><td>2000-11-26 17:15:00</td><td>9236</td></tr><tr><th>239</th><td>X3.9</td><td>2003-11-03 10:00:00</td><td>2003-11-03 10:06:00</td><td>2003-11-03 12:30:00</td><td>10488</td></tr><tr><th>286</th><td>X3.8</td><td>2005-01-17 10:00:00</td><td>2005-01-17 09:54:00</td><td>2005-01-17 10:35:00</td><td>10720</td></tr><tr><th>222</th><td>X3.6</td><td>2003-05-28 01:00:00</td><td>2003-05-28 00:50:00</td><td>2003-05-29 00:30:00</td><td>10365</td></tr><tr><th>160</th><td>X3.4</td><td>2001-12-28 20:35:00</td><td>2001-12-28 20:30:00</td><td>2001-12-29 03:00:00</td><td>9756</td></tr><tr><th>332</th><td>X3.4</td><td>2006-12-13 02:45:00</td><td>2006-12-13 02:54:00</td><td>2006-12-13 10:40:00</td><td>10930</td></tr><tr><th>192</th><td>X3.3</td><td>2002-07-20 21:30:00</td><td>2002-07-20 22:06:00</td><td>2002-07-20 22:20:00</td><td>10039</td></tr><tr><th>404</th><td>X3.2</td><td>2013-05-14 01:16:00</td><td>2013-05-14 01:25:00</td><td>2013-05-14 08:20:00</td><td>11748</td></tr><tr><th>201</th><td>X3.1</td><td>2002-08-24 01:45:00</td><td>2002-08-24 01:27:00</td><td>2002-08-24 03:25:00</td><td>10069</td></tr><tr><th>403</th><td>X2.8</td><td>2013-05-13 16:15:00</td><td>2013-05-13 16:07:00</td><td>2013-05-13 19:10:00</td><td>11748</td></tr><tr><th>19</th><td>X2.7</td><td>1998-05-06 08:25:00</td><td>1998-05-06 08:29:00</td><td>1998-05-06 08:35:00</td><td>8210</td></tr><tr><th>238</th><td>X2.7</td><td>2003-11-03 01:15:00</td><td>2003-11-03 01:59:00</td><td>2003-11-03 01:25:00</td><td>10488</td></tr><tr><th>487</th><td>X2.7</td><td>2015-05-05 22:24:00</td><td>2015-05-05 22:24:00</td><td>2015-05-05 23:14:00</td><td>12339</td></tr><tr><th>9</th><td>X2.6</td><td>1997-11-27 13:30:00</td><td>1997-11-27 13:56:00</td><td>1997-11-27 14:00:00</td><td>8113</td></tr><tr><th>142</th><td>X2.6</td><td>2001-09-24 10:45:00</td><td>2001-09-24 10:30:00</td><td>2001-09-25 20:00:00</td><td>9632</td></tr><tr><th>284</th><td>X2.6</td><td>2005-01-15 23:00:00</td><td>2005-01-15 23:06:00</td><td>2005-01-17 00:00:00</td><td>10720</td></tr><tr><th>276</th><td>X2.5</td><td>2004-11-10 02:25:00</td><td>2004-11-10 02:26:00</td><td>2004-11-10 03:40:00</td><td>10696</td></tr><tr><th>73</th><td>X2.3</td><td>2000-06-06 15:20:00</td><td>2000-06-06 15:54:00</td><td>2000-06-08 09:00:00</td><td>9026</td></tr><tr><th>99</th><td>X2.3</td><td>2000-11-24 15:25:00</td><td>2000-11-24 15:30:00</td><td>2000-11-24 22:00:00</td><td>9236</td></tr><tr><th>123</th><td>X2.3</td><td>2001-04-10 05:24:00</td><td>2001-04-10 05:30:00</td><td>2001-04-10 23:59:00</td><td>9415</td></tr><tr><th>345</th><td>X2.2</td><td>2011-02-15 02:10:00</td><td>2011-02-15 02:24:00</td><td>2011-02-15 07:00:00</td><td>11158</td></tr><tr><th>7</th><td>X2.1</td><td>1997-11-04 06:00:00</td><td>1997-11-04 06:10:00</td><td>1997-11-05 04:30:00</td><td>8100</td></tr><tr><th>318</th><td>X2.1</td><td>2005-09-10 21:45:00</td><td>2005-09-10 21:52:00</td><td>2005-09-11 01:00:00</td><td>10808</td></tr><tr><th>361</th><td>X2.1</td><td>2011-09-06 22:30:00</td><td>2011-09-06 23:05:00</td><td>2011-09-07 15:40:00</td><td>11283</td></tr><tr><th>420</th><td>X2.1</td><td>2013-10-25 15:08:00</td><td>2013-10-25 15:12:00</td><td>2013-10-25 22:32:00</td><td>11882</td></tr><tr><th>98</th><td>X2.0</td><td>2000-11-24 05:10:00</td><td>2000-11-24 05:30:00</td><td>2000-11-24 15:00:00</td><td>9236</td></tr><tr><th>125</th><td>X2.0</td><td>2001-04-12 10:20:00</td><td>2001-04-12 10:31:00</td><td>2001-04-12 10:40:00</td><td>9415</td></tr><tr><th>274</th><td>X2.0</td><td>2004-11-07 16:25:00</td><td>2004-11-07 16:54:00</td><td>2004-11-08 20:00:00</td><td>10696</td></tr><tr><th>285</th><td>X2.0</td><td>2005-01-17 09:25:00</td><td>2005-01-17 09:30:00</td><td>2005-01-17 16:00:00</td><td>10720</td></tr><tr><th>102</th><td>X1.9</td><td>2000-11-25 19:00:00</td><td>2000-11-25 19:31:00</td><td>2000-11-25 19:35:00</td><td>9236</td></tr></tbody></table>
</div></div></div><div style="margin:5px 0"><div><div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>X Class</th><th>Start</th><th>Maximum</th><th>End</th><th>Region</th></tr></thead><tbody><tr><th>8</th><td>X9.4</td><td>1997-11-06 12:20:00</td><td>1997-11-06 12:10:00</td><td>1997-11-07 08:30:00</td><td>8100</td></tr><tr><th>514</th><td>X9.3</td><td>2017-09-06 12:05:00</td><td>2017-09-06 12:24:00</td><td>2017-09-07 08:00:00</td><td>12673</td></tr><tr><th>237</th><td>X8.3</td><td>2003-11-02 17:30:00</td><td>2003-11-02 17:30:00</td><td>2003-11-03 01:00:00</td><td>10486</td></tr><tr><th>515</th><td>X8.3</td><td>2017-09-10 16:02:00</td><td>2017-09-10 16:00:00</td><td>2017-09-11 06:50:00</td><td>NaN</td></tr><tr><th>288</th><td>X7.1</td><td>2005-01-20 07:15:00</td><td>2005-01-20 06:54:00</td><td>2005-01-20 16:30:00</td><td>10720</td></tr><tr><th>359</th><td>X6.9</td><td>2011-08-09 08:20:00</td><td>2011-08-09 08:12:00</td><td>2011-08-09 08:35:00</td><td>11263</td></tr><tr><th>331</th><td>X6.5</td><td>2006-12-06 19:00:00</td><td>NaT</td><td>2006-12-08 23:59:00</td><td>10930</td></tr><tr><th>317</th><td>X6.2</td><td>2005-09-09 19:45:00</td><td>2005-09-09 19:48:00</td><td>2005-09-09 22:00:00</td><td>10808</td></tr><tr><th>82</th><td>X5.7</td><td>2000-07-14 10:30:00</td><td>2000-07-14 10:54:00</td><td>2000-07-15 14:30:00</td><td>9077</td></tr><tr><th>121</th><td>X5.6</td><td>2001-04-06 19:35:00</td><td>2001-04-06 19:30:00</td><td>2001-04-07 01:50:00</td><td>9415</td></tr><tr><th>375</th><td>X5.4</td><td>2012-03-07 01:00:00</td><td>2012-03-07 00:24:00</td><td>2012-03-08 19:00:00</td><td>11429</td></tr><tr><th>135</th><td>X5.3</td><td>2001-08-25 16:50:00</td><td>2001-08-25 16:50:00</td><td>2001-08-25 23:00:00</td><td>9591</td></tr><tr><th>443</th><td>X4.9</td><td>2014-02-25 00:56:00</td><td>2014-02-25 01:25:00</td><td>2014-02-25 11:28:00</td><td>11990</td></tr><tr><th>193</th><td>X4.8</td><td>2002-07-23 00:50:00</td><td>2002-07-23 00:42:00</td><td>2002-07-23 04:00:00</td><td>10039</td></tr><tr><th>239</th><td>X3.9</td><td>2003-11-03 10:00:00</td><td>2003-11-03 10:06:00</td><td>2003-11-03 12:30:00</td><td>10488</td></tr><tr><th>286</th><td>X3.8</td><td>2005-01-17 10:00:00</td><td>2005-01-17 09:54:00</td><td>2005-01-17 10:35:00</td><td>10720</td></tr><tr><th>222</th><td>X3.6</td><td>2003-05-28 01:00:00</td><td>2003-05-28 00:50:00</td><td>2003-05-29 00:30:00</td><td>10365</td></tr><tr><th>160</th><td>X3.4</td><td>2001-12-28 20:35:00</td><td>2001-12-28 20:30:00</td><td>2001-12-29 03:00:00</td><td>9756</td></tr><tr><th>332</th><td>X3.4</td><td>2006-12-13 02:45:00</td><td>2006-12-13 02:54:00</td><td>2006-12-13 10:40:00</td><td>10930</td></tr><tr><th>192</th><td>X3.3</td><td>2002-07-20 21:30:00</td><td>2002-07-20 22:06:00</td><td>2002-07-20 22:20:00</td><td>10039</td></tr><tr><th>404</th><td>X3.2</td><td>2013-05-14 01:16:00</td><td>2013-05-14 01:25:00</td><td>2013-05-14 08:20:00</td><td>11748</td></tr><tr><th>201</th><td>X3.1</td><td>2002-08-24 01:45:00</td><td>2002-08-24 01:27:00</td><td>2002-08-24 03:25:00</td><td>10069</td></tr><tr><th>403</th><td>X2.8</td><td>2013-05-13 16:15:00</td><td>2013-05-13 16:07:00</td><td>2013-05-13 19:10:00</td><td>11748</td></tr><tr><th>19</th><td>X2.7</td><td>1998-05-06 08:25:00</td><td>1998-05-06 08:29:00</td><td>1998-05-06 08:35:00</td><td>8210</td></tr><tr><th>238</th><td>X2.7</td><td>2003-11-03 01:15:00</td><td>2003-11-03 01:59:00</td><td>2003-11-03 01:25:00</td><td>10488</td></tr><tr><th>487</th><td>X2.7</td><td>2015-05-05 22:24:00</td><td>2015-05-05 22:24:00</td><td>2015-05-05 23:14:00</td><td>12339</td></tr><tr><th>9</th><td>X2.6</td><td>1997-11-27 13:30:00</td><td>1997-11-27 13:56:00</td><td>1997-11-27 14:00:00</td><td>8113</td></tr><tr><th>142</th><td>X2.6</td><td>2001-09-24 10:45:00</td><td>2001-09-24 10:30:00</td><td>2001-09-25 20:00:00</td><td>9632</td></tr><tr><th>284</th><td>X2.6</td><td>2005-01-15 23:00:00</td><td>2005-01-15 23:06:00</td><td>2005-01-17 00:00:00</td><td>10720</td></tr></tbody></table>
</div></div></div><div style="white-space:pre-wrap;word-wrap:break-word;font-family:monospace;padding-top:5px;padding-bottom:5px"><span>29
</span></div></div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><h3 id="integration"><span><u>Integration</u></span></h3></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><h3 id="the-best-matching-rows-across-the-nasa--top-50-solar-flare-datasets-are-determined-by-whether-their-start-times-and-x-classes-are-the-same-the-function-below-first-compares-the-start-times-of-the-dataset-rows-if-the-start-dates-match-the-function-determines-whether-the-x-classes-are-the-same-the-function-creates-a-rank-column-in-the-nasa-dataset-if-the-x-classes-match-the-function-appends-the-row&#x27;s-rank-to-the-rank-column-of-the-nasa-dataset-below-we-can-see-the-top-50-solar-flares"><span>The best matching rows across the Nasa &amp; Top 50 Solar Flare datasets are determined by whether their start times and X Classes are the same. The function below first compares the start times of the dataset rows. If the start dates match, the function determines whether the X Classes are the same. The function creates a Rank column in the Nasa Dataset. If the X Classes match, the function appends the row&#x27;s rank to the Rank Column of the Nasa Dataset. Below, we can see the Top 50 Solar Flares.</span></h3></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px">In [<!-- -->0<!-- -->]:</div><div style="width:100%;border-radius:2px;position:relative;overflow-x:auto;border:1px solid rgb(207, 207, 207)"><pre class="CodeMirror cm-s-default  CodeMirror-wrap" style="width:100%;overflow-x:auto;line-height:normal;height:auto;font-size:inherit;margin-bottom:0;padding:4px;white-space:pre-wrap;word-wrap:break-word;word-break:normal;border:0;background:white"><div style="margin-left:0"><span class="cm-keyword">def</span><span> </span><span class="cm-def">best_matching_rows</span><span>(</span><span class="cm-variable">df1</span><span>,</span><span> </span><span class="cm-variable">df2</span><span>)</span><span>:</span><span>
</span><span>   </span><span>
</span><span>    </span><span class="cm-comment"># Create Rank column</span><span>
</span><span>    </span><span class="cm-variable">df1</span><span>[</span><span class="cm-string">&quot;Rank&quot;</span><span>]</span><span> </span><span>=</span><span> </span><span class="cm-string">&quot;&quot;</span><span>
</span><span>    </span><span class="cm-variable">Rank</span><span> </span><span>=</span><span> </span><span>[</span><span>]</span><span>
</span><span>    </span><span>
</span><span>    </span><span class="cm-comment"># Loop over both datasets</span><span>
</span><span>    </span><span class="cm-keyword">for</span><span> </span><span class="cm-variable">i</span><span> </span><span class="cm-keyword">in</span><span> </span><span class="cm-builtin">range</span><span>(</span><span class="cm-builtin">len</span><span>(</span><span class="cm-variable">df1</span><span>)</span><span>)</span><span>:</span><span>
</span><span>        </span><span>
</span><span>        </span><span class="cm-variable">rank_i</span><span> </span><span>=</span><span> </span><span class="cm-variable">np</span><span>.</span><span class="cm-variable">nan</span><span>
</span><span>        </span><span class="cm-variable">rank1</span><span> </span><span>=</span><span> </span><span class="cm-builtin">str</span><span>(</span><span class="cm-variable">df1</span><span>[</span><span class="cm-string">&quot;X Class&quot;</span><span>]</span><span>[</span><span class="cm-variable">i</span><span>]</span><span>)</span><span>
</span><span>        </span><span>
</span><span>        </span><span class="cm-comment"># Check if X class starts with X</span><span>
</span><span>        </span><span class="cm-keyword">if</span><span> </span><span class="cm-variable">nasa_copy</span><span>[</span><span class="cm-string">&quot;firstcol&quot;</span><span>]</span><span>[</span><span class="cm-variable">i</span><span>]</span><span> </span><span class="cm-operator">==</span><span> </span><span class="cm-string">&#x27;X&#x27;</span><span>:</span><span>
</span><span>            </span><span>
</span><span>            </span><span class="cm-keyword">for</span><span> </span><span class="cm-variable">j</span><span> </span><span class="cm-keyword">in</span><span> </span><span class="cm-builtin">range</span><span>(</span><span class="cm-builtin">len</span><span>(</span><span class="cm-variable">df2</span><span>)</span><span>)</span><span>:</span><span>
</span><span>            </span><span>
</span><span>                </span><span class="cm-comment"># Check if Start dates match</span><span>
</span><span>                </span><span class="cm-keyword">if</span><span> </span><span class="cm-variable">df2</span><span>[</span><span class="cm-string">&#x27;Start&#x27;</span><span>]</span><span>[</span><span class="cm-variable">j</span><span>]</span><span>.</span><span class="cm-variable">date</span><span>(</span><span>)</span><span> </span><span class="cm-operator">==</span><span> </span><span class="cm-variable">df1</span><span>[</span><span class="cm-string">&#x27;Start&#x27;</span><span>]</span><span>[</span><span class="cm-variable">i</span><span>]</span><span>.</span><span class="cm-variable">date</span><span>(</span><span>)</span><span>:</span><span>
</span><span>
</span><span>                    </span><span class="cm-variable">rank1</span><span> </span><span>=</span><span> </span><span class="cm-builtin">str</span><span>(</span><span class="cm-variable">df1</span><span>[</span><span class="cm-string">&#x27;X Class&#x27;</span><span>]</span><span>[</span><span class="cm-variable">i</span><span>]</span><span>)</span><span>
</span><span>                    </span><span class="cm-variable">rank1</span><span> </span><span>=</span><span> </span><span class="cm-variable">rank1</span><span>.</span><span class="cm-variable">replace</span><span>(</span><span class="cm-string">&#x27;X&#x27;</span><span>,</span><span class="cm-string">&#x27;&#x27;</span><span>)</span><span>
</span><span>                    </span><span class="cm-variable">rank1</span><span> </span><span>=</span><span> </span><span class="cm-variable">rank1</span><span>.</span><span class="cm-variable">replace</span><span>(</span><span class="cm-string">&#x27;+&#x27;</span><span>,</span><span class="cm-string">&#x27;&#x27;</span><span>)</span><span>
</span><span>
</span><span>                    </span><span class="cm-variable">rank2</span><span> </span><span>=</span><span> </span><span class="cm-builtin">str</span><span>(</span><span class="cm-variable">df2</span><span>[</span><span class="cm-string">&#x27;X Class&#x27;</span><span>]</span><span>[</span><span class="cm-variable">j</span><span>]</span><span>)</span><span>
</span><span>                    </span><span class="cm-variable">rank2</span><span> </span><span>=</span><span> </span><span class="cm-variable">rank2</span><span>.</span><span class="cm-variable">replace</span><span>(</span><span class="cm-string">&#x27;X&#x27;</span><span>,</span><span class="cm-string">&#x27;&#x27;</span><span>)</span><span>
</span><span>                    </span><span class="cm-variable">rank2</span><span> </span><span>=</span><span> </span><span class="cm-variable">rank2</span><span>.</span><span class="cm-variable">replace</span><span>(</span><span class="cm-string">&#x27;+&#x27;</span><span>,</span><span class="cm-string">&#x27;&#x27;</span><span>)</span><span>
</span><span>
</span><span>                    </span><span class="cm-variable">rank1</span><span> </span><span>=</span><span> </span><span class="cm-builtin">float</span><span>(</span><span class="cm-variable">rank1</span><span>)</span><span>
</span><span>                    </span><span class="cm-variable">rank2</span><span> </span><span>=</span><span> </span><span class="cm-builtin">float</span><span>(</span><span class="cm-variable">rank2</span><span>)</span><span>
</span><span>
</span><span>                    </span><span class="cm-comment"># Check if X Classes match</span><span>
</span><span>                    </span><span class="cm-keyword">if</span><span> </span><span class="cm-variable">rank2</span><span> </span><span class="cm-operator">==</span><span> </span><span class="cm-variable">rank1</span><span>:</span><span>
</span><span>                        </span><span class="cm-variable">rank_i</span><span> </span><span>=</span><span> </span><span class="cm-variable">df2</span><span>.</span><span class="cm-variable">loc</span><span>[</span><span class="cm-variable">j</span><span>]</span><span>[</span><span class="cm-string">&quot;Rank&quot;</span><span>]</span><span>
</span><span>                        </span><span>
</span><span>        </span><span class="cm-comment"># Add rank to dataframe if Start date &amp; X Class matches</span><span>
</span><span>        </span><span class="cm-variable">df1</span><span>.</span><span class="cm-variable">at</span><span>[</span><span class="cm-variable">i</span><span>,</span><span> </span><span class="cm-string">&quot;Rank&quot;</span><span>]</span><span> </span><span>=</span><span> </span><span class="cm-variable">rank_i</span><span>
</span><span>        </span><span>
</span><span>    </span><span class="cm-comment"># Sort dataset by Rank</span><span>
</span><span>    </span><span class="cm-variable">df1</span><span> </span><span>=</span><span> </span><span class="cm-variable">df1</span><span>.</span><span class="cm-variable">sort_values</span><span>(</span><span class="cm-variable">by</span><span>=</span><span>[</span><span class="cm-string">&#x27;Rank&#x27;</span><span>]</span><span>)</span><span>
</span><span>    </span><span>
</span><span>    </span><span class="cm-comment"># Drop rows with no Rank</span><span>
</span><span>    </span><span class="cm-variable">df1</span><span> </span><span>=</span><span> </span><span class="cm-variable">df1</span><span>.</span><span class="cm-variable">dropna</span><span>(</span><span>)</span><span>
</span><span>    </span><span>
</span><span>    </span><span class="cm-keyword">return</span><span> </span><span class="cm-variable">df1</span><span>
</span></div></pre></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px">In [<!-- -->0<!-- -->]:</div><div style="width:100%;border-radius:2px;position:relative;overflow-x:auto;border:1px solid rgb(207, 207, 207)"><pre class="CodeMirror cm-s-default  CodeMirror-wrap" style="width:100%;overflow-x:auto;line-height:normal;height:auto;font-size:inherit;margin-bottom:0;padding:4px;white-space:pre-wrap;word-wrap:break-word;word-break:normal;border:0;background:white"><div style="margin-left:0"><span class="cm-variable">best_matching_rows</span><span>(</span><span class="cm-variable">nasa_df</span><span>,</span><span> </span><span class="cm-variable">top50_df</span><span>)</span><span>
</span></div></pre></div></div><div style="display:flex;flex-direction:row;align-items:stretch" cocalc-test="cell-output"><div class="ant-btn ant-btn-default" style="border-color:transparent;font-size:inherit;padding:0;display:flex;flex-direction:column;height:auto"><div style="color:#D84315;min-width:7em;font-family:monospace;text-align:right;padding-right:5px;padding-bottom:2px"></div><div style="flex:1"></div> </div><div style="flex:1;overflow-x:auto;line-height:normal;background-color:#fff;border:0;margin-bottom:0;margin-left:1px" class="cocalc-jupyter-rendered"><div style="margin:5px 0"><div><div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>X Class</th><th>Start</th><th>Maximum</th><th>End</th><th>Region</th><th>Rank</th></tr></thead><tbody><tr><th>240</th><td>X28.</td><td>2003-11-04 20:00:00</td><td>2003-11-04 19:54:00</td><td>2003-11-04 23:59:00</td><td>10486</td><td>1</td></tr><tr><th>117</th><td>X20.</td><td>2001-04-02 22:05:00</td><td>2001-04-02 22:06:00</td><td>2001-04-03 02:30:00</td><td>9393</td><td>2</td></tr><tr><th>234</th><td>X10.</td><td>2003-10-29 20:55:00</td><td>2003-10-29 20:54:00</td><td>2003-10-29 23:59:00</td><td>10486</td><td>6</td></tr><tr><th>8</th><td>X9.4</td><td>1997-11-06 12:20:00</td><td>1997-11-06 12:10:00</td><td>1997-11-07 08:30:00</td><td>8100</td><td>7</td></tr><tr><th>514</th><td>X9.3</td><td>2017-09-06 12:05:00</td><td>2017-09-06 12:24:00</td><td>2017-09-07 08:00:00</td><td>12673</td><td>8</td></tr><tr><th>237</th><td>X8.3</td><td>2003-11-02 17:30:00</td><td>2003-11-02 17:30:00</td><td>2003-11-03 01:00:00</td><td>10486</td><td>10</td></tr><tr><th>288</th><td>X7.1</td><td>2005-01-20 07:15:00</td><td>2005-01-20 06:54:00</td><td>2005-01-20 16:30:00</td><td>10720</td><td>12</td></tr><tr><th>359</th><td>X6.9</td><td>2011-08-09 08:20:00</td><td>2011-08-09 08:12:00</td><td>2011-08-09 08:35:00</td><td>11263</td><td>13</td></tr><tr><th>317</th><td>X6.2</td><td>2005-09-09 19:45:00</td><td>2005-09-09 19:48:00</td><td>2005-09-09 22:00:00</td><td>10808</td><td>15</td></tr><tr><th>82</th><td>X5.7</td><td>2000-07-14 10:30:00</td><td>2000-07-14 10:54:00</td><td>2000-07-15 14:30:00</td><td>9077</td><td>17</td></tr><tr><th>121</th><td>X5.6</td><td>2001-04-06 19:35:00</td><td>2001-04-06 19:30:00</td><td>2001-04-07 01:50:00</td><td>9415</td><td>18</td></tr><tr><th>375</th><td>X5.4</td><td>2012-03-07 01:00:00</td><td>2012-03-07 00:24:00</td><td>2012-03-08 19:00:00</td><td>11429</td><td>19</td></tr><tr><th>135</th><td>X5.3</td><td>2001-08-25 16:50:00</td><td>2001-08-25 16:50:00</td><td>2001-08-25 23:00:00</td><td>9591</td><td>22</td></tr><tr><th>443</th><td>X4.9</td><td>2014-02-25 00:56:00</td><td>2014-02-25 01:25:00</td><td>2014-02-25 11:28:00</td><td>11990</td><td>23</td></tr><tr><th>193</th><td>X4.8</td><td>2002-07-23 00:50:00</td><td>2002-07-23 00:42:00</td><td>2002-07-23 04:00:00</td><td>10039</td><td>25</td></tr><tr><th>104</th><td>X4.0</td><td>2000-11-26 17:00:00</td><td>2000-11-26 17:06:00</td><td>2000-11-26 17:15:00</td><td>9236</td><td>26</td></tr><tr><th>239</th><td>X3.9</td><td>2003-11-03 10:00:00</td><td>2003-11-03 10:06:00</td><td>2003-11-03 12:30:00</td><td>10488</td><td>27</td></tr><tr><th>286</th><td>X3.8</td><td>2005-01-17 10:00:00</td><td>2005-01-17 09:54:00</td><td>2005-01-17 10:35:00</td><td>10720</td><td>29</td></tr><tr><th>222</th><td>X3.6</td><td>2003-05-28 01:00:00</td><td>2003-05-28 00:50:00</td><td>2003-05-29 00:30:00</td><td>10365</td><td>33</td></tr><tr><th>332</th><td>X3.4</td><td>2006-12-13 02:45:00</td><td>2006-12-13 02:54:00</td><td>2006-12-13 10:40:00</td><td>10930</td><td>34</td></tr><tr><th>160</th><td>X3.4</td><td>2001-12-28 20:35:00</td><td>2001-12-28 20:30:00</td><td>2001-12-29 03:00:00</td><td>9756</td><td>35</td></tr><tr><th>192</th><td>X3.3</td><td>2002-07-20 21:30:00</td><td>2002-07-20 22:06:00</td><td>2002-07-20 22:20:00</td><td>10039</td><td>37</td></tr><tr><th>404</th><td>X3.2</td><td>2013-05-14 01:16:00</td><td>2013-05-14 01:25:00</td><td>2013-05-14 08:20:00</td><td>11748</td><td>39</td></tr><tr><th>201</th><td>X3.1</td><td>2002-08-24 01:45:00</td><td>2002-08-24 01:27:00</td><td>2002-08-24 03:25:00</td><td>10069</td><td>41</td></tr><tr><th>403</th><td>X2.8</td><td>2013-05-13 16:15:00</td><td>2013-05-13 16:07:00</td><td>2013-05-13 19:10:00</td><td>11748</td><td>43</td></tr><tr><th>487</th><td>X2.7</td><td>2015-05-05 22:24:00</td><td>2015-05-05 22:24:00</td><td>2015-05-05 23:14:00</td><td>12339</td><td>46</td></tr><tr><th>238</th><td>X2.7</td><td>2003-11-03 01:15:00</td><td>2003-11-03 01:59:00</td><td>2003-11-03 01:25:00</td><td>10488</td><td>47</td></tr><tr><th>19</th><td>X2.7</td><td>1998-05-06 08:25:00</td><td>1998-05-06 08:29:00</td><td>1998-05-06 08:35:00</td><td>8210</td><td>48</td></tr><tr><th>284</th><td>X2.6</td><td>2005-01-15 23:00:00</td><td>2005-01-15 23:06:00</td><td>2005-01-17 00:00:00</td><td>10720</td><td>49</td></tr><tr><th>142</th><td>X2.6</td><td>2001-09-24 10:45:00</td><td>2001-09-24 10:30:00</td><td>2001-09-25 20:00:00</td><td>9632</td><td>50</td></tr></tbody></table>
</div></div></div></div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><h3 id="analysis-plot"><span><u>Analysis Plot</u></span></h3></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><h3 id="this-analysis-plot-seeks-to-answer-whether-flares-in-the-top-50-tend-to-have-halo-cmes-or-not-this-bar-plot-compares-the-number-of-halo-cmes-in-the-top-50-flares-vs-the-dataset-as-a-whole-the-code-below-calculates-the-proportion-of-halo-cmes-in-nasa&#x27;s-top-50-solar-flares-and-the-entire-nasa-solar-flares-dataset-by-taking-the-average-of-the-isflare-column-"><span>This analysis plot seeks to answer whether flares in the top 50 tend to have Halo CMEs or not. This bar plot compares the number of Halo CMEs in the top 50 flares vs. the dataset as a whole. The code below calculates the proportion of Halo CMEs in Nasa&#x27;s top 50 solar flares and the entire Nasa solar flares dataset by taking the average of the is_flare column. </span></h3><h3 id="the-bar-graph-below-shows-that-nasa&#x27;s-top-50-solar-flares-tend-to-have-halo-cmes-the-difference-in-proportion-between-the-halo-cmes-count-for-the-total-data-and-the-halo-cmes-count-for-the-top-50-data-is-approximately-28-"><span>The bar graph below shows that Nasa&#x27;s Top 50 solar flares tend to have Halo CMEs. The difference in proportion between the Halo CMEs count for the total data and the Halo CMEs count for the Top 50 data is approximately 28%. </span></h3></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px">In [<!-- -->0<!-- -->]:</div><div style="width:100%;border-radius:2px;position:relative;overflow-x:auto;border:1px solid rgb(207, 207, 207)"><pre class="CodeMirror cm-s-default  CodeMirror-wrap" style="width:100%;overflow-x:auto;line-height:normal;height:auto;font-size:inherit;margin-bottom:0;padding:4px;white-space:pre-wrap;word-wrap:break-word;word-break:normal;border:0;background:white"><div style="margin-left:0"><span class="cm-keyword">import</span><span> </span><span class="cm-variable">matplotlib</span><span>.</span><span class="cm-variable">pyplot</span><span> </span><span class="cm-keyword">as</span><span> </span><span class="cm-variable">plt</span><span>
</span><span>
</span><span class="cm-variable">is_flare_top50</span><span> </span><span>=</span><span> </span><span class="cm-variable">nasa_is_flare</span><span>.</span><span class="cm-variable">loc</span><span>[</span><span class="cm-variable">nasa_is_flare</span><span>[</span><span class="cm-string">&#x27;importance&#x27;</span><span>]</span><span>.</span><span class="cm-variable">isin</span><span>(</span><span class="cm-variable">top50_df</span><span>[</span><span class="cm-string">&#x27;X Class&#x27;</span><span>]</span><span>)</span><span>]</span><span>
</span><span class="cm-variable">is_flare_top50</span><span> </span><span>=</span><span> </span><span class="cm-variable">is_flare_top50</span><span>.</span><span class="cm-variable">is_flare</span><span>.</span><span class="cm-variable">mean</span><span>(</span><span>)</span><span>
</span><span class="cm-variable">is_flare_total</span><span> </span><span>=</span><span> </span><span class="cm-variable">nasa_is_flare</span><span>.</span><span class="cm-variable">is_flare</span><span>.</span><span class="cm-variable">mean</span><span>(</span><span>)</span><span>
</span><span>
</span><span class="cm-variable">plt</span><span>.</span><span class="cm-variable">bar</span><span>(</span><span>[</span><span class="cm-number">0</span><span>,</span><span class="cm-number">1</span><span>]</span><span>,</span><span> </span><span>[</span><span class="cm-variable">is_flare_total</span><span>,</span><span> </span><span class="cm-variable">is_flare_top50</span><span>]</span><span>,</span><span> </span><span class="cm-variable">align</span><span>=</span><span class="cm-string">&#x27;center&#x27;</span><span>,</span><span class="cm-variable">color</span><span>=</span><span class="cm-string">&#x27;darksalmon&#x27;</span><span>)</span><span>
</span><span class="cm-variable">plt</span><span>.</span><span class="cm-variable">xticks</span><span>(</span><span>[</span><span class="cm-number">0</span><span>,</span><span class="cm-number">1</span><span>]</span><span>,</span><span> </span><span>[</span><span class="cm-string">&#x27;Total Halo CMEs Count&#x27;</span><span>,</span><span> </span><span class="cm-string">&#x27;Top 50 Halo CMEs Count&#x27;</span><span>]</span><span>)</span><span>
</span><span class="cm-variable">plt</span><span>.</span><span class="cm-variable">ylabel</span><span>(</span><span class="cm-string">&#x27;Number of CMEs&#x27;</span><span>)</span><span>
</span><span class="cm-variable">plt</span><span>.</span><span class="cm-variable">title</span><span>(</span><span class="cm-string">&#x27;Halo CMEs in the Nasa Solar Flare Dataset&#x27;</span><span>)</span><span>
</span><span>
</span><span class="cm-builtin">print</span><span>(</span><span class="cm-string">&quot;Halo CMEs count for Top 50 data:&quot;</span><span>,</span><span> </span><span>(</span><span class="cm-variable">is_flare_top50</span><span> </span><span class="cm-operator">-</span><span> </span><span class="cm-variable">is_flare_total</span><span>)</span><span>)</span><span>
</span></div></pre></div></div><div style="display:flex;flex-direction:row;align-items:stretch" cocalc-test="cell-output"><div class="ant-btn ant-btn-default" style="border-color:transparent;font-size:inherit;padding:0;display:flex;flex-direction:column;height:auto"><div style="color:#D84315;min-width:7em;font-family:monospace;text-align:right;padding-right:5px;padding-bottom:2px"></div><div style="flex:1"></div> </div><div style="flex:1;overflow-x:auto;line-height:normal;background-color:#fff;border:0;margin-bottom:0;margin-left:1px" class="cocalc-jupyter-rendered"><div style="white-space:pre-wrap;word-wrap:break-word;font-family:monospace;padding-top:5px;padding-bottom:5px"><span>0.27586206896551724</span></div><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAYIAAAEICAYAAABS0fM3AAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy%2FMnkTPAAAACXBIWXMAAAsTAAALEwEAmpwYAAAiPklEQVR4nO3de5wcVZn%2F8c%2BXAHIHhYiQAIkaVqNAVocg%2FlBgFTcIEsALCYgbVo1Ro4DoGpVFXNQVEUUFjRHZ4GWJioIRB3HXlYsKkgCBkCgaA5IQLsPNcBMIPL8%2FzhmpVLp7apKpGZL6vl%2Bvfk1dTp16urqmn6pzqqsUEZiZWXNtNNQBmJnZ0HIiMDNrOCcCM7OGcyIwM2s4JwIzs4ZzIjAzazgngmchSVMk%2FXqo4xgIkj4u6dwBrO82Sa8fqPrWZ5JGSQpJGw%2FCumZL%2BnTd67Gh4URQg1ZfVoP55S7paEnzJT0s6U5Jl0raL887NX95fLC0zAl5%2Bql5%2FABJT%2Bc6iq99%2BxNLRHw2It61lu%2Bj1i%2Bf%2FH4XStqoMO3TkmbXtc42cewn6beS%2Firpfkm%2FkbT3YMaQ45gi6anS5332EMRxuaS%2FSXpI0kpJ10maIek5%2FagjJL24zjgHcz11cyLYwEj6EHAW8FlgR2BX4GvAxEKxPwL%2FUlr0HXl60YqI2Kr0urqeyIfMzsCkoVq5pG2AS4CvAs8DRgCfAh6veb3tziKuLn3e09dxPSom2n6YHhFbAzsBJ5E%2Bo25JWpd4rDUngiGSj3D%2BnI96Fks6okPZV0ual48Y50l6dZty2wL%2FAbw%2FIn4cEY9ExJMR8dOI%2BEih6DxgC0kvy8u9DNg8T68a%2FxRJS3P8t0o6pk25UyV9Nw%2F3NmX8i6TbJd0r6RNtlpsKHAP8Wz4y%2FWlh9jhJN%2BXt8X1JmxWWO1TSAkkP5qPsPft4K58HPtXui1HSDyXdldd1Ze82y%2FPemD%2B7hyTdIenDefpzJV0iqUfSA3l4ZJv17w4QERdExFMR8VhE%2FCIibsp1bSTpZEl%2FkXSPpG%2Fnz7lVrMdJ%2Bn2OZ6mk9xTmHSBpuaSPSroL%2BK8%2Btktbfb2%2FfET%2FGUm%2FAR4FXijpJZL%2BJ5%2Fx3CLpbVXWlffhy4HDgH2BQ%2FI6xku6On%2FOd0o6W9Kmed6VefEb875zVIWY2%2B7Pkv41b9cHJF0mabd261nbbTrUnAiGzp%2BB1wDbko4Avytpp3IhSc8DfgZ8Bdge%2BCLwM0nbt6hzX2Az4KIK6%2F8O6SwA0tnBt6sGLmnLHM%2FB%2Bajt1cCCqssD%2BwH%2FALwOOEXSS8sFImIW8D3g8%2FnI9E2F2W8DJgCjgT2BKTmuVwDnAe8hbatvAHPVuUnhx8DK3jpauBQYAzwfuD7H1OtbwHvyNng58H95%2BkakL9rdSGdkjwHtmlj%2BCDwl6XxJB0t6bmn%2BlPw6EHghsFWHuu4BDgW2AY4DvpS3Sa8XkM46dgOmtqmjiirv79i8jq2BHuB%2FgP8mbcfJwNeKSbUvEXE7MJ%2F0PwPwFHAisANpv38d8L5c9rW5zF553%2Fl%2Bp5g77c%2BSDgc%2BDhwJDAeuAi7osJ71U0T4NcAv4DbgYeDBwutR4NcdllkATMzDU3rLkv6hri2VvRqY0qKOY4C7%2BojtVOC7pH%2BG24FN8t9d8vRTc7kDgKdL7%2BFBYMv8ehB4M7B5lfXl4VFAACML868FJrVZdjbw6Rbb9u2F8c8DM%2FPw14HTSuVvAfZvU38ALwbemLfBc4BPA7PblN8uL7NtHr%2BdlHS26WMbjAMe6DD%2Fpfm9LgdWAXOBHfO8XwLvK5T9B%2BBJYOPC9ty4Tb0XA8cXPs8ngM06xDElr7%2F4eb%2Bq3WfR7v0BlwP%2FURg%2FCriqtMw3gE%2B2qe9y4F0tps8BvtlmmROAi8qfbZXPhA77M%2BlA4J2F8Y1I%2F8u7VVnP%2BvLyGUF9Do%2BI7Xpf5KOVXpLeUWjCeJB0RLlDi3p2Bv5SmvYXUlty2X3ADu2aOYoiHWEtIfUl%2FCkilrUotqL4HvLrkYh4hPTPPQ24U9LPJL2kr3UW3FUYfpR0lNsf7ZbfDTipd5vm7boLaRu2FRHdpC%2F11Y6SJQ2T9DmlJryVpCQEz3xObyYlkb9IukK5I13SFpK%2BkZtzVgJXAttJGtZm%2Fb%2BPiCkRMZK0H%2BxM6ueBNT%2F%2Fv5CSwI7levIZxTW5%2BeXBHFtxn%2BqJiL912hbANaXP%2B5oW66ny%2For7027APqXP5RjSGUp%2FjADuzzHsnpt37soxfJbW%2Fz99xtzH%2Frwb8OVC3PcDovX%2F33rLiWAI5DbGbwLTge1zoriZtIOVrSDtjEW7Ane0KHs18Dfg8IqhfJvUEVe5WahXRFwWEQeROvP%2BQHo%2FA62%2Ft8ZdBnym9EW2RURcUGHZk4FPAFsUph1N6mR%2FPakJb1SeLoCImBcRE0nNHRcDP8jzTyIdue8TEdsAry0u10lE%2FIF09P3yPKn8%2Be9KOmq%2Fu7hcbv76EfAF0tnEdkB3aZ0DdavhKu%2BvuK5lwBWlz2WriHhv1RVK2gV4JalpBtLZ3x%2BAMTmGj9N5%2B3aMucP%2BvIzU%2FFeMffOI%2BG3V2NcHTgRDY0vSP0oPpE4%2BnvnHL%2BsGdle6JHTj3CE1lnSlyWoi4q%2FAKcA5kg7PR0Gb5CPFz7eo%2B%2FvAG3jmC6wSSTtKOiy3rT5OagZ7qj91VHQ3qV28qm8C0yTto2RLSYdI2rqvBSN1SC5k9auptia9v%2FtICeKzvTMkbSrpGEnbRsSTpH6GpwrLPQY8mPt4PtluvUqdqCf1dlzmL7zJQO%2BR%2BAXAiZJGS9oqx%2FD9iFhVqmpTUtNWD7BK0sGkz7YOld9fdglpHz4274%2BbSNq7Vd9QWd6H9wd%2BQmpG7C7EsBJ4OB%2B9l5NKed9pG3Mf%2B%2FNM4GN65sKKbSW9tcN61ktOBEMgIhYDZ5KO4O8G9gB%2B06bsfaQOwJNIX0j%2FBhwaEfe2Kf9F4EOkI9we0hHNdNIRa7nsYxHxvxHxWJtQd9aavyN4M2m%2FOYl0tHo%2FsD%2Blpq8B8i1gbD4tXyP%2BsoiYD7yb1An4AKnpa0o%2F1ncyqTO117dJTTF3AIt55su517HAbbmpYRrw9jz9LNJVWPfmZX7eYZ0PAfsAv5P0SC5%2FM2n7Qur8%2Fg6pKeNW0hnfB8qVRMRDwAdJSf0B0tnM3D7e79o6i%2Brvrze2N5AuAV1Bato7nZS42jlb0kOk%2F4%2BzSGc7EyLi6Tz%2Fw6T3%2BBDpAKDcUXsqcH7ed97WR8xt9%2BeIuCjHOid%2FzjcDB3dYz3pJucPDzMwaymcEZmYN50RgZtZwTgRmZg3nRGBm1nC13752oO2www4xatSooQ7DzGy9ct11190bEcNbzVvvEsGoUaOYP3%2F%2BUIdhZrZekVS%2BQ8HfuWnIzKzhnAjMzBrOicDMrOGcCMzMGs6JwMys4ZwIzMwazonAzKzhnAjMzBrOicDMrOHWu18Wm23o7vn6J4Y6BHuWev57P1NLvT4jMDNrOCcCM7OGqzURSJog6RZJSyTNaDF%2FW0k%2FlXSjpEX5Ie5mZjaIaksEkoYB55Ae9DwWmCxpbKnY%2B4HFEbEXcABwpqRN64rJzMzWVOcZwXhgSUQsjYgngDnAxFKZALaWJGAr4H5gVY0xmZlZSZ2JYASwrDC%2BPE8rOht4KbACWAgcHxFP1xiTmZmV1JkI1GJalMb%2FGVgA7AyMA86WtM0aFUlTJc2XNL%2Bnp2eg4zQza7Q6E8FyYJfC%2BEjSkX%2FRccCPI1kC3Aq8pFxRRMyKiK6I6Bo%2BvOWT1szMbC3VmQjmAWMkjc4dwJOAuaUytwOvA5C0I%2FAPwNIaYzIzs5LaflkcEaskTQcuA4YB50XEIknT8vyZwGnAbEkLSU1JH42Ie%2BuKyczM1lTrLSYiohvoLk2bWRheAbyhzhjMzKwz%2F7LYzKzhnAjMzBrOicDMrOGcCMzMGs6JwMys4ZwIzMwazonAzKzhnAjMzBrOicDMrOGcCMzMGs6JwMys4ZwIzMwazonAzKzhnAjMzBrOicDMrOGcCMzMGq7WRCBpgqRbJC2RNKPF%2FI9IWpBfN0t6StLz6ozJzMxWV1sikDQMOAc4GBgLTJY0tlgmIs6IiHERMQ74GHBFRNxfV0xmZramOs8IxgNLImJpRDwBzAEmdig%2FGbigxnjMzKyFOhPBCGBZYXx5nrYGSVsAE4Af1RiPmZm1UGciUItp0absm4DftGsWkjRV0nxJ83t6egYsQDMzqzcRLAd2KYyPBFa0KTuJDs1CETErIroiomv48OEDGKKZmdWZCOYBYySNlrQp6ct%2BbrmQpG2B%2FYGf1BiLmZm1sXFdFUfEKknTgcuAYcB5EbFI0rQ8f2YuegTwi4h4pK5YzMysvdoSAUBEdAPdpWkzS%2BOzgdl1xmFmZu35l8VmZg3nRGBm1nBOBGZmDedEYGbWcE4EZmYN50RgZtZwTgRmZg3nRGBm1nBOBGZmDedEYGbWcE4EZmYN50RgZtZwTgRmZg3nRGBm1nBOBGZmDedEYGbWcE4EZmYNV2sikDRB0i2Slkia0abMAZIWSFok6Yo64zEzszXV9qhKScOAc4CDgOXAPElzI2Jxocx2wNeACRFxu6Tn1xWPmZm1VucZwXhgSUQsjYgngDnAxFKZo4EfR8TtABFxT43xmJlZC3UmghHAssL48jytaHfguZIul3SdpHe0qkjSVEnzJc3v6empKVwzs2bqMxFI2lLSRnl4d0mHSdqkQt1qMS1K4xsDrwQOAf4Z%2BHdJu6%2BxUMSsiOiKiK7hw4dXWLWZmVVV5YzgSmAzSSOAXwLHAbMrLLcc2KUwPhJY0aLMzyPikYi4N69rrwp1m5nZAKmSCBQRjwJHAl%2BNiCOAsRWWmweMkTRa0qbAJGBuqcxPgNdI2ljSFsA%2BwO%2Brh29mZuuqylVDkrQvcAzwzqrLRcQqSdOBy4BhwHkRsUjStDx%2FZkT8XtLPgZuAp4FzI%2BLmtXkjZma2dqokguOBjwEX5S%2FyFwK%2FqlJ5RHQD3aVpM0vjZwBnVAvXzMwGWpUj%2BytJbfe940slfajWqMzMbNC07SOQ9OvC8HdKs6%2BtLSIzMxtUnTqLtywMv7w0r9WloWZmth7qlAiizXCrcTMzW0916iPYTtIRpGSxnaQj83QB29YemZmZDYpOieAK4LDC8JsK865cs7iZma2P2iaCiDhuMAMZDPd8%2FRNDHYI9iz3%2FvZ8Z6hDMhkTbRNDXJaIR8cWBD8fMzAZbp6ahLwALgEuBx%2FGVQmZmG6ROieAVpPsDHQJcB1wA%2FDIifMWQmdkGpO3loxGxICJmRMQ44Fukh8oslnRYu2XMzGz9U%2BV5BMOBfwT2IN022k8RMzPbgHTqLD4OOArYDLgQeJsfJWlmtuHp1EfwLWAhcDvp6WFvkJ7pL44INxGZmW0AOiWCAwctCjMzGzKdEsFiYHhELC5OlPQy3E9gZrbB6NRZ%2FFWg1ZPiRwJfrlK5pAmSbpG0RNKMFvMPkPRXSQvy65RqYZuZ2UDpdEawR0RcUZ4YEZdJOrOviiUNA84BDiJdbTRP0tzyGQZwVUQc2p%2Bgzcxs4HQ6I9hkLef1Gg8siYilEfEEMIf0WwQzM3sW6ZQI%2FiTpjeWJkg4GllaoewSwrDC%2BPE8r21fSjZIuzf0Pa5A0VdJ8SfN7enoqrNrMzKrq1DR0InCJpLeRbjEB0AXsC1Rpyml1b6Ly7SmuB3aLiIdz0rkYGLPGQhGzgFkAXV1dvsWFmdkA6nSLiT%2BSfk18BTAqv64A9szz%2BrIc2KUwPhJYUVrHyoh4OA93A5tI2qEf8ZuZ2TrqdEZARDwO%2FNda1j0PGCNpNHAH6QZ2RxcLSHoBcHdEhKTxpMR031quz8zM1kLHRLAuImKVpOnAZcAw4LyIWCRpWp4%2FE3gL8F5Jq4DHgEm%2Bu6mZ2eCqLRHA35t7ukvTZhaGzwbOrjMGMzPrrG0fgaRf5r%2BnD144ZmY22DqdEewkaX%2FgMElzKF0FFBHX1xqZmZkNik6J4BRgBulqn%2FLziQP4p7qCMjOzwdM2EUTEhcCFkv49Ik4bxJjMzGwQ9dlZHBGn5cdTvjZPujwiLqk3LDMzGyxVHlX5n8DxpNtSLwaOz9PMzGwDUOXy0UOAcRHxNICk84EbgI%2FVGZiZmQ2OPs8Isu0Kw9vWEIeZmQ2RKmcE%2FwncIOlXpEtIX4vPBszMNhhVOosvkHQ5sDcpEXw0Iu6qOzAzMxsclW4xERF3AnNrjsXMzIZA1T4CMzPbQDkRmJk1XMdEIGkjSTcPVjBmZjb4OiaC%2FNuBGyXtOkjxmJnZIKvSWbwTsEjStcAjvRMj4rDaojIzs0FTJRF8am0rlzQB%2BDLpCWXnRsTn2pTbG7gGOCrf7M7MzAZJld8RXCFpN2BMRPyvpC1IX%2BwdSRoGnAMcRHqQ%2FTxJcyNicYtyp5MeaWlmZoOsyk3n3g1cCHwjTxoBXFyh7vHAkohYGhFPAHOAiS3KfQD4EXBPlYDNzGxgVbl89P3A%2FwNWAkTEn4DnV1huBLCsML48T%2Fs7SSOAI4CZdCBpqqT5kub39PRUWLWZmVVVJRE8no%2FoAZC0MekJZX1Ri2nl5c4i3bLiqU4VRcSsiOiKiK7hw4dXWLWZmVVVpbP4CkkfBzaXdBDwPuCnFZZbDuxSGB8JrCiV6QLmSALYAXijpFURcXGF%2Bs3MbABUSQQzgHcCC4H3AN3AuRWWmweMkTQauAOYBBxdLBARo3uHJc0GLnESMDMbXFWuGno6P4zmd6SmnVsios%2BmoYhYJWk66WqgYcB5EbFI0rQ8v2O%2FgJmZDY4%2BE4GkQ0iduX8mtfuPlvSeiLi0r2Ujopt0BlGc1jIBRMSUKgGbmdnAqtI0dCZwYEQsAZD0IuBnQJ%2BJwMzMnv2qXDV0T28SyJbia%2F7NzDYYbc8IJB2ZBxdJ6gZ%2BQOojeCupI9jMzDYAnZqG3lQYvhvYPw%2F3AM%2BtLSIzMxtUbRNBRBw3mIGYmdnQqHLV0GjS%2FYBGFcv7NtRmZhuGKlcNXQx8i%2FRr4qdrjcbMzAZdlUTwt4j4Su2RmJnZkKiSCL4s6ZPAL4DHeydGxPW1RWVmZoOmSiLYAzgW%2BCeeaRqKPG5mZuu5KongCOCFxVtRm5nZhqPKL4tvBLarOQ4zMxsiVc4IdgT%2BIGkeq%2FcR%2BPJRM7MNQJVE8MnaozAzsyFT5XkEVwxGIGZmNjSq%2FLL4IZ551vCmwCbAIxGxTZ2BmZnZ4Oizszgito6IbfJrM%2BDNwNlVKpc0QdItkpZImtFi%2FkRJN0laIGm%2BpP36%2FxbMzGxdVLlqaDX5mcJ9%2FoZA0jDgHOBgYCwwWdLYUrFfAntFxDjgX6n2LGQzMxtAVZqGjiyMbgR08UxTUSfjgSURsTTXMweYCCzuLRARDxfKb1mxXjMzG0BVrhoqPpdgFXAb6Qu9LyOAZYXx5cA%2B5UKSjgD%2BE3g%2BcEiriiRNBaYC7LrrrhVWbWZmVVW5amhtn0ugVtW1qP8i4CJJrwVOA17foswsYBZAV1eXzxrMzAZQp0dVntJhuYiI0%2FqoezmwS2F8JLCiQ4VXSnqRpB0i4t4%2B6jYzswHSqbP4kRYvgHcCH61Q9zxgjKTRkjYFJgFziwUkvViS8vArSJen3tevd2BmZuuk06Mqz%2BwdlrQ1cDxwHDAHOLPdcoXlV0maDlwGDAPOi4hFkqbl%2BTNJl6K%2BQ9KTwGPAURHhph8zs0HUsY9A0vOADwHHAOcDr4iIB6pWHhHdQHdp2szC8OnA6f0J2MzMBlanPoIzgCNJnbR7lC71NDOzDUSnPoKTgJ2Bk4EVklbm10OSVg5OeGZmVrdOfQT9%2FtWxmZmtf%2Fxlb2bWcE4EZmYN50RgZtZwTgRmZg3nRGBm1nBOBGZmDedEYGbWcE4EZmYN50RgZtZwTgRmZg3nRGBm1nBOBGZmDedEYGbWcLUmAkkTJN0iaYmkGS3mHyPppvz6raS96ozHzMzWVFsikDQMOAc4GBgLTJY0tlTsVmD%2FiNgTOI30EBwzMxtEdZ4RjAeWRMTSiHiC9KzjicUCEfHbwqMvrwFG1hiPmZm1UGciGAEsK4wvz9PaeSdwaasZkqZKmi9pfk9PzwCGaGZmdSYCtZgWLQtKB5ISwUdbzY%2BIWRHRFRFdw4cPH8AQzcys7aMqB8ByYJfC%2BEhgRbmQpD2Bc4GDI%2BK%2BGuMxM7MW6jwjmAeMkTRa0qbAJGBusYCkXYEfA8dGxB9rjMXMzNqo7YwgIlZJmg5cBgwDzouIRZKm5fkzgVOA7YGvSQJYFRFddcVkZmZrqrNpiIjoBrpL02YWht8FvKvOGMzMrDP%2FstjMrOGcCMzMGs6JwMys4ZwIzMwazonAzKzhnAjMzBrOicDMrOGcCMzMGs6JwMys4ZwIzMwazonAzKzhnAjMzBrOicDMrOGcCMzMGs6JwMys4ZwIzMwartZEIGmCpFskLZE0o8X8l0i6WtLjkj5cZyxmZtZabU8okzQMOAc4iPQg%2B3mS5kbE4kKx%2B4EPAofXFYeZmXVW5xnBeGBJRCyNiCeAOcDEYoGIuCci5gFP1hiHmZl1UGciGAEsK4wvz9P6TdJUSfMlze%2Fp6RmQ4MzMLKkzEajFtFibiiJiVkR0RUTX8OHD1zEsMzMrqjMRLAd2KYyPBFbUuD4zM1sLdSaCecAYSaMlbQpMAubWuD4zM1sLtV01FBGrJE0HLgOGAedFxCJJ0%2FL8mZJeAMwHtgGelnQCMDYiVtYVl5mZra62RAAQEd1Ad2nazMLwXaQmIzMzGyL%2BZbGZWcM5EZiZNZwTgZlZwzkRmJk1nBOBmVnDORGYmTWcE4GZWcM5EZiZNZwTgZlZwzkRmJk1nBOBmVnDORGYmTWcE4GZWcM5EZiZNZwTgZlZwzkRmJk1XK2JQNIESbdIWiJpRov5kvSVPP8mSa%2BoMx4zM1tTbYlA0jDgHOBgYCwwWdLYUrGDgTH5NRX4el3xmJlZa3WeEYwHlkTE0oh4ApgDTCyVmQh8O5JrgO0k7VRjTGZmVlLnM4tHAMsK48uBfSqUGQHcWSwkaSrpjAHgYUm3DGyojbUDcO9QB%2FGs8b7PDnUEtibvo0Xrto%2Fu1m5GnYlALabFWpQhImYBswYiKHuGpPkR0TXUcZi14310cNTZNLQc2KUwPhJYsRZlzMysRnUmgnnAGEmjJW0KTALmlsrMBd6Rrx56FfDXiLizXJGZmdWntqahiFglaTpwGTAMOC8iFkmalufPBLqBNwJLgEeB4%2BqKx1pyc5s923kfHQSKWKNJ3szMGsS%2FLDYzazgnAjOzhnMi6EDS9pIW5Nddku4ojG9aKnuCpC0q1Hm5pDUuhytPlzRK0s191NVnmRbL7C6pO9%2FW4%2FeSfiBpR0kHSApJ7yyU%2Fcc87cN5fLakWwvb4Lf9WO8LJM2R9GdJi3MMu%2Fcn9grrOEDSqweyzmeb%2FuyTFes7QNJfC3WcUpjX8RYxucypvftHYdptknboY719limV30rSN%2FL%2Bs0jSlZL2yfNC0ncKZTeW1CPpkjw%2BJY8vKLzKdzlot95NJH1O0p8k3SzpWkkHV4274jpGSTp6IOvsrzp%2FR7Dei4j7gHGQdnjg4Yj4QpviJwDfJXV6PytJ2gz4GfChiPhpnnYgMDwXWQgcBXwrj08CbixV85GIuLCf6xVwEXB%2BREzK08YBOwJ%2F7P87aesA4GGgcoJa3%2FRzn6zqqog4tDihcIuYg0iXec%2BTNDciFq%2FjutbWucCtwJiIeFrSC4GX5nmPAC%2BXtHlEPEaK%2BY7S8t%2BPiOlrsd7TgJ2Al0fE45J2BPZfu7fQ1ijgaOC%2FB7jeynxG0E%2BSXifpBkkLJZ0n6TmSPgjsDPxK0q9yua9Lmp%2BPXj61juscJekqSdfn1xpHvZI2k%2FRfOa4b8hd82dHA1b1JACAifhURvWcVtwOb5TMEAROASyvEt3%2FhSOsGSVuXihwIPJmvFOtd74KIuErJGfloa6Gko3KdB%2FQe0eXxsyVNycO3SfpU3hYLJb1E0ihgGnBijuM1fcW9oWi1T%2Bbpt0k6PR%2FFXivpxf2otsotYqrEdrGk6%2FL%2FwdQ2ZT6UP%2F%2BbJZ3QYv6LSHclODkingbIcf2sUOxS4JA8PBm4oEJsO%2BUziwV53a8pzd8CeDfwgYh4PK%2F37oj4QZ4%2FOW%2FzmyWdXlju4cLwWyTNzsOzlW6y%2BVtJSyW9JRf7HPCaHMeJfcVdByeC%2FtkMmA0cFRF7kM6o3hsRXyH9EO7AiOj9Av5E%2FkXknsD%2BkvasUP%2F3er9QSZfW9roHOCgiXkE6Yv9Ki2XfD5Djmgycn88Ail4OXNdHDBcCbwVeDVwPPF6af0bhS%2F97edqHgfdHxDjgNcBj%2FVjvkaQj3L2A1%2Bf6q9xv6t68Pb4OfDgibgNmAl%2BKiHERcVWFOjYELffJwvyVETEeOBs4q00d%2B0q6UdKlkl6Wp7W7%2FUsrJxb2iQWkg6Je%2FxoRrwS6gA9K2r64oKRXki4b3wd4FfBuSf9Yqv9lwIKIeKrN%2BiElqkl5n98T%2BF1p%2FlFavWloc9KB0WV5v90LWFBa5sXA7RGxsrwySTsDpwP%2FRNp%2F95Z0eIf4eu0E7AccSkoAADNIZ2XjIuJLFeoYcE4E%2FTMMuDUiepszzgde26bs2yRdD9xA2pGrtEkek3eGcaTfV%2FTaBPimpIXAD9vUtR%2FwHYCI%2BAPwF2Bt2uB%2FQEoE7Y6qPtIbY0Qck6f9BvhiPjPaLiJW9WN9%2BwEXRMRTEXE3cAWwd4Xlfpz%2FXkc6tW6qvvbJCwp%2F922x%2FPXAbhGxF%2FBV4OI8vdLtX7IvFfaJcax%2Bd4APSroRuIZ0F4ExpWX3Ay6KiEci4mHS59rvs7mIuIm0H0xm9YOoXt8vxpibkOYBx%2BUmtj0i4qF%2BrHJv4PKI6Mn7%2B%2Fdo%2F11QdHFEPJ2b2Hbsx%2Fpq5UTQP49UKSRpNOko%2BXURsSepXb58dN4fJwJ3k45auoBWnYKt%2FnHLFgGv7FQgIu4CniS1s%2F6ySnAR8TngXcDmwDWSXtKP9baLexWr75%2Fl7dd7pvIUze7r6mufjDbDaULEyvwFTER0A5sodeKu8%2B1fJB1AOsvbNyeaG1jzc6y63%2B4lqa%2Fvq7nAF6jQLAQQEVeSvrzvAL4j6R2lIkuAXVs0dULnuIvbud1%2B21cdg8qJoH82A0YV2lqPJR3BAjwE9O4w25D%2BQf%2Bq1Lm0rlcZbAvcmdtHjyUdBZZdCRwD6cogYFegfJfW%2FwZeLam3LbX3ypA9SuVOAT7ax6n430l6UUQsjIjTgflAORH8H%2FAcSe8uLLO3pP1z3EdJGiZpOOkf81rSGc1YpT6YbYHXVQil%2BBk0Rad9ElJTYu%2Ffq8sLK13NpTw8nvSdcB%2FVbhHTl22BByLi0Xxw8KoWZa4EDpe0haQtgSOA1Zr1IuLPpP3qU4VYx0gq91mcB%2FxHRCysEpyk3YB7IuKbpAskVnswVkQ8mqd%2FJW%2BD3n6Ft5OanvaXtINSx%2Fpkntnud0t6aU5cR1QIZcj32yYfSa2Nv5HaM38oaWPSP0tvB%2Bgs4FJJd0bEgZJuIB3JLCU1nayLrwE%2FkvRW4Fe0Pgr8GjAzNx%2BtAqb0dnD1iojHJB0KnCXpLNKR%2F03A8cD2hXKdrro5Q9LJhfHxwAlKndNPAYspdTBHREg6Iq93Bmk73ka60upKUpPFjaQjqX%2FLZyVI%2BkGO70%2Bko8m%2B%2FBS4MH9BfKAh%2FQSd9klICfh3pC%2F4yS2WfwvwXkmrSH07kyLdbqDlLWL6GdvPgWmSbiIdlFxTLhAR1%2BfO1GvzpHMjotVn%2FS7gTGCJpEdJyeojpbqWA19uE8tRkvYrjL%2BP1Ez1EUlPkq42K58RAJwMfBpYLOlvpP%2B9UyLiTkkfI%2F0%2FCuiOiJ%2FkZWYAl5D6WG4GtmoTU6%2BbSNv7RmD2UPQT%2BBYTZhsoSbcBXRHh%2B%2FlbR24aMjNrOJ8RmJk1nM8IzMwazonAzKzhnAjMzBrOicDMrOGcCMzMGu7%2FA0PJDfeCkXVbAAAAAElFTkSuQmCC" style="max-width:100%;height:auto" alt="Image in a Jupyter notebook"/></div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><h3 id="i-hope-you-found-this-data-analysis-tutorial-on-solar-flare-data-interesting-thank-you-for-reading"><span>I hope you found this data analysis tutorial on Solar Flare data interesting. Thank you for reading!!</span></h3></div></div><div></div></div></div></div>
</body>
